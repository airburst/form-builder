/*! FormBuilder 2016-11-10 */
function sendId(a){"use strict";a.preventDefault();var b=$(this).closest("[data-id]").data("id");$.publish($(this).data("eventName"),b)}function getFormName(){"use strict";var a=FB.utils.getUrlParameter("type").toLowerCase();switch(a){case"adoption":return"Adoption Enquiry";case"fostering":return"Fostering Enquiry";case"":return"Adoption and Fostering Enquiry"}}function transposePersonNames(){"use strict";var a=[],b=$("[id=benname] option");$.each(b,function(b){a.push({id:b+1,name:$(this).text()})}),$.each($("[id=allincoutmonthly] tr"),function(b){if(b>0){var c=$("td:first",$(this)),d=$.grep(a,function(a){return a.id==c.text()});"0"===c.text()?c.text("Totals"):void 0!==d[0]&&c.text(d[0].name)}})}function showNegativeRows(){"use strict";var a=$("#p15, #p17"),b=$("td",a);$.each(b,function(){parseFloat($(this).text())<0&&$(this).closest("tr").addClass("danger")})}function cleanCurrency(){"use strict";var a=$("#p15, #p17"),b=[$("#p1hhsum td:nth-child(2)"),$("#p1hhsum td:nth-child(3)"),$("#accomdetails tr:nth-child(12) td:nth-child(2)")],c=$("td",a);$.each(c,function(){var a,c=$(this),d=!1;$.each(b,function(e){for(a=0;a<b[e].length;a++)c[0]===b[e][a]&&(d=!0)}),d||$(this).html(FB.utils.currencyTest($(this).text()))})}function populateAccomTable(){"use strict";var a=[];a.push([1,"Occupier Status",$("#p1occstatus").val()]),a.push([2,"Landlord Type",$("#p1landlord").val()]);var b=""!=$("#newpostcode").val()?$("#newpostcode").val():$("#postcode").val();a.push([3,"Postcode",b]),a.push([4,"Local Authority",$("#la").val()]),a.push([5,"Council Tax Band",$("#band").val()]),a.push([6,"Tenacy Type",$("#p1tentype").val()]),a.push([7,"Supported Exempt?",$("[name=p1supported]:checked").val()]),a.push([8,"Non Self Contained?",$("[name=p1nonself]:checked").val()]),a.push([9,"Carer Bedroom Needed?",$("[name=p1carerbed]:checked").val()]),a.push([10,"Property Type",$("#p1proptype").val()]),a.push([11,"Net Rent",$("#p1rent").val()]),FBRun.tablegroup.setData($("[id=accomdetails]"),a)}function filterHousehold(a,b,c){"use strict";var d=JSON.parse(FBRun.tablegroup.getData($("#hhin"))),e=!1;return d.data.forEach(function(d){switch(b){case"GTE":parseFloat(d[a],10)>=parseFloat(c,10)&&(e=!0);break;case"CONTAINS":d[a].indexOf(c)>-1&&(e=!0)}}),e}function employedInHousehold(){"use strict";return filterHousehold(EMP_STATUS,"CONTAINS","Employed")}function nonDepInHousehold(){"use strict";return filterHousehold(RELATIONSHIP,"CONTAINS","dep")}function pensionerInHousehold(){"use strict";return filterHousehold(AGE,"GTE",65)}function incomeVisibility(){"use strict";return FBRun.vis.applyRule($("#p3"),employedInHousehold()),FBRun.vis.applyRule($("#p5"),pensionerInHousehold()),FBRun.vis.applyRule($("#p7"),nonDepInHousehold()),!1}function addOtherValue(a){"use strict";var b=a.data.target;FB.utils.addItemToSelect(b,$(this).val()),b.val($(this).val())}function getDistance(a,b,c,d){var e=0;return a=parseFloat(a),b=parseFloat(b),c=parseFloat(c),d=parseFloat(d),e=Math.sqrt(Math.pow(a-c,2)+Math.pow(b-d,2))/1e3,e=Math.floor(e/1.6142+.5)}function parsePostcode(a){var b;return a=a.replace(/\s/g,""),b=a.length,0===b?"":5>b?(console.log("Error: postcode is too short"),""):b>7?(console.log("Error: postcode is too long"),""):5===b?a.substring(0,2)+"  "+a.substring(2,5):6===b?a.substring(0,3)+" "+a.substring(3,6):a}function writeBRMAResults(a,b){"use strict";var c=JSON.parse(a),d=[];$.each(c,function(a,b){d.push({text:b.name,value:b.name})});var e=FB.utils.distinct(d,"value");FB.utils.updateSelect(b,e)}function writePostcodeResults(a){"use strict";var b=JSON.parse(a),c=$("#mode").val();FBRun.northing[c]=b[0].no,FBRun.easting[c]=b[0].ea}function writeDistrictResults(a,b){"use strict";var c=JSON.parse(a);b.val(c[0].name)}function brmaQuery(a,b){"use strict";var c=$.ajax({type:"GET",url:"/service/brma/"+a+"/",dataType:"json",success:function(){writeBRMAResults(c.responseText,b)},error:function(){bootbox.alert("Error looking up BRMA")},fail:function(){bootbox.alert("Problem getting BRMA service")}})}function postcodeQuery(a){"use strict";var b=$.ajax({type:"GET",url:"/service/postcode/"+a+"/",dataType:"json",success:function(){writePostcodeResults(b.responseText)},error:function(){bootbox.alert("Error looking up postcode")},fail:function(){bootbox.alert("Problem getting postcode service")}})}function districtQuery(a,b){"use strict";var c=$.ajax({type:"GET",url:"/service/postcode/"+a+"/district",dataType:"json",success:function(){writeDistrictResults(c.responseText,b)},error:function(){bootbox.alert("Error looking up District")},fail:function(){bootbox.alert("Problem reaching District service")}})}function getBrma(a){"use strict";var b=parsePostcode(a);brmaQuery(b,$("#brma")),postcodeQuery(b),districtQuery(b,$("#la"))}function getPostcodeGeo(a){"use strict";var b=parsePostcode(a);postcodeQuery(b)}function laAutoComplete(){"use strict";$("#la").autocomplete({source:new LocalAuthorities})}function removeRowFromTable(a,b,c){"use strict";var d,e=!1;void 0!==c&&(e=!0),$.each($("tr",a),function(a,c){d=!1,$.each($("td",c),function(){e?$(this).text()==b&&(d=!0):$(this).text().indexOf(b)>-1&&(d=!0)}),d&&$(this).remove()})}function doMovingOn(){"use strict";return $("#mode").val("SPMO"),$("#mode").trigger("change"),FBRun.empty(74),FBRun.empty(91),FBRun.empty(98),FBRun.empty(105),FBRun.empty(111),removeRowFromTable($("#priorityin"),"Council tax","exact"),$("#p17 .btn-next").addClass("hide"),$("#p17 .btn-submit").removeClass("hide"),$(".sidenav li[data-page!=p16]").removeClass("active").addClass("disabled"),FBRun.nav.moveTo("p2"),!1}function prevent(a){"use strict";a.preventDefault(),a.stopPropagation()}function doCustomPreProcessing(){"use strict";FBRun.empty(127),$("#spname").text($("#fname").val()+" "+$("#lname").val()),$("#spaddress").text($("#address1").val()+" "+FB.utils.concatIf($("#address2").val(),$("#address3").val(),$("#postcode").val())),$("#sptel").text($("#hometel").val()),$("#spmob").text($("#mobiletel").val()),$("#spemail").text($("#email").val()),FBRun.tablegroup.copyTable($("#hhin table"),$("#p1hhsum")),populateAccomTable();var a=$("#mode").val(),b="SPMO"===a?2:1,c="Staying Put",d=$("#panelp"+b);(2===b||"MO"===a)&&(c="Moving On");var e=new $.ShelterTemplates,f=e.panelTpl(b);$(".panel-heading",d).html(c).addClass("subhead"),$(".panel-body",d).html(f),$("#printdetailstop, #printdetailsbottom, .btn-summary-p"+b).click(function(a){a.preventDefault(),a.stopPropagation(),window.print()}),$(".btn-details-p"+b).click(prevent)}function doCustomPostProcessing(){"use strict";var a,b=JSON.parse(calc.response),c=parseFloat(b["incandexpsummaryp1-r6-c2"],10),d=parseFloat(b["accomdetails-r4-c2"],10),e=parseInt($("#p1bedrooms").val(),10),f=(d+c)/4.333333,g=$("#mode").val(),h="SPMO"===g?2:1,i=$("#panelp"+h);0>c&&(a=new $.ShelterTemplates,$(".row:first",i).after(a.alertTpl(h,f,e)),$(".btn-lha-"+h).click(prevent)),transposePersonNames(),showNegativeRows(),cleanCurrency(),$.each($(".table-responsive",i),function(){var a=$(this).attr("id");$(this).attr("id",a+h)}),results.push({html:$("#p15 .fb-form").html(),property:h}),FBRun.nav.moveTo("p17")}function showDetails(a){"use strict";var b="p15",c=$("#"+b),d="";$.each(results,function(b,c){c.property===a&&(d=c.html)}),$(".fb-form",c).html(d),$(".sidenav-container",c).remove(),$(".fb-form",c).removeClass("col-md-9").addClass("col-md-12"),$(".btn",c).click(prevent),FBRun.nav.moveTo(b)}function addBenefit(a,b,c){"use strict";return $.each($("#p4 table tr"),function(){$("td:nth-child(2)",$(this)).text()===b&&$(this).remove()}),$("#benname").val(a),$("#bentype").val(b),$("#benfreq").val("4.3333330"),$("#benamt").val(c).toCurrency(),$("#p4 .table-group button").trigger("click"),$("#p4 .table-group button").trigger("click"),!1}function calculateBenefits(){"use strict";var a,b,c=JSON.parse(FBRun.tablegroup.getData($("#hhin"))),d=5,e=6,f=7,g=8,h=20.5,i=13.55,j=61.35,k=0,l=0,m=0,n=0,o=0;return $.each(c.data,function(c,h){a=("Child"===h[d]||"Foster Child"===h[d])&&(h[e].indexOf("student")>-1||h[e].indexOf("child")>-1),a&&k++,b="Y"===h[f]&&"Y"===h[g],b&&(m++,o=1===m?c+1:o)}),k>0&&(l=k>1?h+(k-1)*i:h,addBenefit(1,"Child benefit",l)),m>0&&(n=j,addBenefit(o,"Carer's allowance",n)),!1}function beta(a){"use strict";void 0===calcData?bootbox.alert("There is no error dump data to show.  Please paste the dump data into the console first."):(void 0===a&&(a=1),results=calcData,showDetails(a))}(function(){"use strict";var a=this,b=a.Chart,c=function(a){return this.canvas=a.canvas,this.ctx=a,this.width=a.canvas.width,this.height=a.canvas.height,this.aspectRatio=this.width/this.height,d.retinaScale(this),this};c.defaults={global:{animation:!0,animationSteps:60,animationEasing:"easeOutQuart",showScale:!0,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleIntegersOnly:!0,scaleBeginAtZero:!1,scaleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",responsive:!1,maintainAspectRatio:!0,showTooltips:!0,tooltipEvents:["mousemove","touchstart","touchmove","mouseout"],tooltipFillColor:"rgba(0,0,0,0.8)",tooltipFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipFontSize:14,tooltipFontStyle:"normal",tooltipFontColor:"#fff",tooltipTitleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipTitleFontSize:14,tooltipTitleFontStyle:"bold",tooltipTitleFontColor:"#fff",tooltipYPadding:6,tooltipXPadding:6,tooltipCaretSize:8,tooltipCornerRadius:6,tooltipXOffset:10,tooltipTemplate:"<%if (label){%><%=label%>: <%}%><%= value %>",multiTooltipTemplate:"<%= value %>",multiTooltipKeyBackground:"#fff",onAnimationProgress:function(){},onAnimationComplete:function(){}}},c.types={};var d=c.helpers={},e=d.each=function(a,b,c){var d=Array.prototype.slice.call(arguments,3);if(a)if(a.length===+a.length){var e;for(e=0;e<a.length;e++)b.apply(c,[a[e],e].concat(d))}else for(var f in a)b.apply(c,[a[f],f].concat(d))},f=d.clone=function(a){var b={};return e(a,function(c,d){a.hasOwnProperty(d)&&(b[d]=c)}),b},g=d.extend=function(a){return e(Array.prototype.slice.call(arguments,1),function(b){e(b,function(c,d){b.hasOwnProperty(d)&&(a[d]=c)})}),a},h=d.merge=function(){var a=Array.prototype.slice.call(arguments,0);return a.unshift({}),g.apply(null,a)},i=d.indexOf=function(a,b){if(Array.prototype.indexOf)return a.indexOf(b);for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1},j=(d.where=function(a,b){var c=[];return d.each(a,function(a){b(a)&&c.push(a)}),c},d.findNextWhere=function(a,b,c){c||(c=-1);for(var d=c+1;d<a.length;d++){var e=a[d];if(b(e))return e}},d.findPreviousWhere=function(a,b,c){c||(c=a.length);for(var d=c-1;d>=0;d--){var e=a[d];if(b(e))return e}},d.inherits=function(a){var b=this,c=a&&a.hasOwnProperty("constructor")?a.constructor:function(){return b.apply(this,arguments)},d=function(){this.constructor=c};return d.prototype=b.prototype,c.prototype=new d,c.extend=j,a&&g(c.prototype,a),c.__super__=b.prototype,c}),k=d.noop=function(){},l=d.uid=function(){var a=0;return function(){return"chart-"+a++}}(),m=d.warn=function(a){window.console&&"function"==typeof window.console.warn&&console.warn(a)},n=d.amd="function"==typeof a.define&&a.define.amd,o=d.isNumber=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},p=d.max=function(a){return Math.max.apply(Math,a)},q=d.min=function(a){return Math.min.apply(Math,a)},r=(d.cap=function(a,b,c){if(o(b)){if(a>b)return b}else if(o(c)&&c>a)return c;return a},d.getDecimalPlaces=function(a){return a%1!==0&&o(a)?a.toString().split(".")[1].length:0}),s=d.radians=function(a){return a*(Math.PI/180)},t=(d.getAngleFromPoint=function(a,b){var c=b.x-a.x,d=b.y-a.y,e=Math.sqrt(c*c+d*d),f=2*Math.PI+Math.atan2(d,c);return 0>c&&0>d&&(f+=2*Math.PI),{angle:f,distance:e}},d.aliasPixel=function(a){return a%2===0?0:.5}),u=(d.splineCurve=function(a,b,c,d){var e=Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2)),f=Math.sqrt(Math.pow(c.x-b.x,2)+Math.pow(c.y-b.y,2)),g=d*e/(e+f),h=d*f/(e+f);return{inner:{x:b.x-g*(c.x-a.x),y:b.y-g*(c.y-a.y)},outer:{x:b.x+h*(c.x-a.x),y:b.y+h*(c.y-a.y)}}},d.calculateOrderOfMagnitude=function(a){return Math.floor(Math.log(a)/Math.LN10)}),v=(d.calculateScaleRange=function(a,b,c,d,e){var f=2,g=Math.floor(b/(1.5*c)),h=f>=g,i=p(a),j=q(a);i===j&&(i+=.5,j>=.5&&!d?j-=.5:i+=.5);for(var k=Math.abs(i-j),l=u(k),m=Math.ceil(i/(1*Math.pow(10,l)))*Math.pow(10,l),n=d?0:Math.floor(j/(1*Math.pow(10,l)))*Math.pow(10,l),o=m-n,r=Math.pow(10,l),s=Math.round(o/r);(s>g||g>2*s)&&!h;)if(s>g)r*=2,s=Math.round(o/r),s%1!==0&&(h=!0);else if(e&&l>=0){if(r/2%1!==0)break;r/=2,s=Math.round(o/r)}else r/=2,s=Math.round(o/r);return h&&(s=f,r=o/s),{steps:s,stepValue:r,min:n,max:n+s*r}},d.template=function(a,b){function c(a,b){var c=/\W/.test(a)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):d[a]=d[a];return b?c(b):c}if(a instanceof Function)return a(b);var d={};return c(a,b)}),w=(d.generateLabels=function(a,b,c,d){var f=new Array(b);return labelTemplateString&&e(f,function(b,e){f[e]=v(a,{value:c+d*(e+1)})}),f},d.easingEffects={linear:function(a){return a},easeInQuad:function(a){return a*a},easeOutQuad:function(a){return-1*a*(a-2)},easeInOutQuad:function(a){return(a/=.5)<1?.5*a*a:-.5*(--a*(a-2)-1)},easeInCubic:function(a){return a*a*a},easeOutCubic:function(a){return 1*((a=a/1-1)*a*a+1)},easeInOutCubic:function(a){return(a/=.5)<1?.5*a*a*a:.5*((a-=2)*a*a+2)},easeInQuart:function(a){return a*a*a*a},easeOutQuart:function(a){return-1*((a=a/1-1)*a*a*a-1)},easeInOutQuart:function(a){return(a/=.5)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)},easeInQuint:function(a){return 1*(a/=1)*a*a*a*a},easeOutQuint:function(a){return 1*((a=a/1-1)*a*a*a*a+1)},easeInOutQuint:function(a){return(a/=.5)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)},easeInSine:function(a){return-1*Math.cos(a/1*(Math.PI/2))+1},easeOutSine:function(a){return 1*Math.sin(a/1*(Math.PI/2))},easeInOutSine:function(a){return-.5*(Math.cos(Math.PI*a/1)-1)},easeInExpo:function(a){return 0===a?1:1*Math.pow(2,10*(a/1-1))},easeOutExpo:function(a){return 1===a?1:1*(-Math.pow(2,-10*a/1)+1)},easeInOutExpo:function(a){return 0===a?0:1===a?1:(a/=.5)<1?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return a>=1?a:-1*(Math.sqrt(1-(a/=1)*a)-1)},easeOutCirc:function(a){return 1*Math.sqrt(1-(a=a/1-1)*a)},easeInOutCirc:function(a){return(a/=.5)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)},easeInElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1==(a/=1)?1:(c||(c=.3),d<Math.abs(1)?(d=1,b=c/4):b=c/(2*Math.PI)*Math.asin(1/d),-(d*Math.pow(2,10*(a-=1))*Math.sin(2*(1*a-b)*Math.PI/c)))},easeOutElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:1==(a/=1)?1:(c||(c=.3),d<Math.abs(1)?(d=1,b=c/4):b=c/(2*Math.PI)*Math.asin(1/d),d*Math.pow(2,-10*a)*Math.sin(2*(1*a-b)*Math.PI/c)+1)},easeInOutElastic:function(a){var b=1.70158,c=0,d=1;return 0===a?0:2==(a/=.5)?1:(c||(c=.3*1.5),d<Math.abs(1)?(d=1,b=c/4):b=c/(2*Math.PI)*Math.asin(1/d),1>a?-.5*d*Math.pow(2,10*(a-=1))*Math.sin(2*(1*a-b)*Math.PI/c):d*Math.pow(2,-10*(a-=1))*Math.sin(2*(1*a-b)*Math.PI/c)*.5+1)},easeInBack:function(a){var b=1.70158;return 1*(a/=1)*a*((b+1)*a-b)},easeOutBack:function(a){var b=1.70158;return 1*((a=a/1-1)*a*((b+1)*a+b)+1)},easeInOutBack:function(a){var b=1.70158;return(a/=.5)<1?.5*a*a*(((b*=1.525)+1)*a-b):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},easeInBounce:function(a){return 1-w.easeOutBounce(1-a)},easeOutBounce:function(a){return(a/=1)<1/2.75?7.5625*a*a:2/2.75>a?1*(7.5625*(a-=1.5/2.75)*a+.75):2.5/2.75>a?1*(7.5625*(a-=2.25/2.75)*a+.9375):1*(7.5625*(a-=2.625/2.75)*a+.984375)},easeInOutBounce:function(a){return.5>a?.5*w.easeInBounce(2*a):.5*w.easeOutBounce(2*a-1)+.5}}),x=d.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1e3/60)}}(),y=(d.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(a){return window.clearTimeout(a,1e3/60)}}(),d.animationLoop=function(a,b,c,d,e,f){var g=0,h=w[c]||w.linear,i=function(){g++;var c=g/b,j=h(c);a.call(f,j,c,g),d.call(f,j,c),b>g?f.animationFrame=x(i):e.apply(f)};x(i)},d.getRelativePosition=function(a){var b,c,d=a.originalEvent||a,e=a.currentTarget||a.srcElement,f=e.getBoundingClientRect();return d.touches?(b=d.touches[0].clientX-f.left,c=d.touches[0].clientY-f.top):(b=d.clientX-f.left,c=d.clientY-f.top),{x:b,y:c}},d.addEvent=function(a,b,c){a.addEventListener?a.addEventListener(b,c):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c}),z=d.removeEvent=function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent?a.detachEvent("on"+b,c):a["on"+b]=k},A=(d.bindEvents=function(a,b,c){a.events||(a.events={}),e(b,function(b){a.events[b]=function(){c.apply(a,arguments)},y(a.chart.canvas,b,a.events[b])})},d.unbindEvents=function(a,b){e(b,function(b,c){z(a.chart.canvas,c,b)})}),B=d.getMaximumWidth=function(a){var b=a.parentNode;return b.clientWidth},C=d.getMaximumHeight=function(a){var b=a.parentNode;return b.clientHeight},D=(d.getMaximumSize=d.getMaximumWidth,d.retinaScale=function(a){var b=a.ctx,c=a.canvas.width,d=a.canvas.height;window.devicePixelRatio&&(b.canvas.style.width=c+"px",b.canvas.style.height=d+"px",b.canvas.height=d*window.devicePixelRatio,b.canvas.width=c*window.devicePixelRatio,b.scale(window.devicePixelRatio,window.devicePixelRatio))}),E=d.clear=function(a){a.ctx.clearRect(0,0,a.width,a.height)},F=d.fontString=function(a,b,c){return b+" "+a+"px "+c},G=d.longestText=function(a,b,c){a.font=b;var d=0;return e(c,function(b){var c=a.measureText(b).width;d=c>d?c:d}),d},H=d.drawRoundedRectangle=function(a,b,c,d,e,f){a.beginPath(),a.moveTo(b+f,c),a.lineTo(b+d-f,c),a.quadraticCurveTo(b+d,c,b+d,c+f),a.lineTo(b+d,c+e-f),a.quadraticCurveTo(b+d,c+e,b+d-f,c+e),a.lineTo(b+f,c+e),a.quadraticCurveTo(b,c+e,b,c+e-f),a.lineTo(b,c+f),a.quadraticCurveTo(b,c,b+f,c),a.closePath()};c.instances={},c.Type=function(a,b,d){this.options=b,this.chart=d,this.id=l(),c.instances[this.id]=this,b.responsive&&this.resize(),this.initialize.call(this,a)},g(c.Type.prototype,{initialize:function(){return this},clear:function(){return E(this.chart),this},stop:function(){return d.cancelAnimFrame.call(a,this.animationFrame),this},resize:function(a){this.stop();var b=this.chart.canvas,c=B(this.chart.canvas),d=this.options.maintainAspectRatio?c/this.chart.aspectRatio:C(this.chart.canvas);return b.width=this.chart.width=c,b.height=this.chart.height=d,D(this.chart),"function"==typeof a&&a.apply(this,Array.prototype.slice.call(arguments,1)),this},reflow:k,render:function(a){return a&&this.reflow(),this.options.animation&&!a?d.animationLoop(this.draw,this.options.animationSteps,this.options.animationEasing,this.options.onAnimationProgress,this.options.onAnimationComplete,this):(this.draw(),this.options.onAnimationComplete.call(this)),this},generateLegend:function(){return v(this.options.legendTemplate,this)},destroy:function(){this.clear(),A(this,this.events),delete c.instances[this.id]},showTooltip:function(a,b){"undefined"==typeof this.activeElements&&(this.activeElements=[]);var f=function(a){var b=!1;return a.length!==this.activeElements.length?b=!0:(e(a,function(a,c){a!==this.activeElements[c]&&(b=!0)},this),b)}.call(this,a);if(f||b){if(this.activeElements=a,this.draw(),a.length>0)if(this.datasets&&this.datasets.length>1){for(var g,h,j=this.datasets.length-1;j>=0&&(g=this.datasets[j].points||this.datasets[j].bars||this.datasets[j].segments,h=i(g,a[0]),-1===h);j--);var k=[],l=[],m=function(){var a,b,c,e,f,g=[],i=[],j=[];return d.each(this.datasets,function(b){a=b.points||b.bars||b.segments,a[h]&&a[h].hasValue()&&g.push(a[h])}),d.each(g,function(a){i.push(a.x),j.push(a.y),k.push(d.template(this.options.multiTooltipTemplate,a)),l.push({fill:a._saved.fillColor||a.fillColor,stroke:a._saved.strokeColor||a.strokeColor})},this),f=q(j),c=p(j),e=q(i),b=p(i),{x:e>this.chart.width/2?e:b,y:(f+c)/2}}.call(this,h);new c.MultiTooltip({x:m.x,y:m.y,xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,xOffset:this.options.tooltipXOffset,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,titleTextColor:this.options.tooltipTitleFontColor,titleFontFamily:this.options.tooltipTitleFontFamily,titleFontStyle:this.options.tooltipTitleFontStyle,titleFontSize:this.options.tooltipTitleFontSize,cornerRadius:this.options.tooltipCornerRadius,labels:k,legendColors:l,legendColorBackground:this.options.multiTooltipKeyBackground,title:a[0].label,chart:this.chart,ctx:this.chart.ctx}).draw()}else e(a,function(a){var b=a.tooltipPosition();new c.Tooltip({x:Math.round(b.x),y:Math.round(b.y),xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,caretHeight:this.options.tooltipCaretSize,cornerRadius:this.options.tooltipCornerRadius,text:v(this.options.tooltipTemplate,a),chart:this.chart}).draw()},this);return this}},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)}}),c.Type.extend=function(a){var b=this,d=function(){return b.apply(this,arguments)};if(d.prototype=f(b.prototype),g(d.prototype,a),d.extend=c.Type.extend,a.name||b.prototype.name){var e=a.name||b.prototype.name,i=c.defaults[b.prototype.name]?f(c.defaults[b.prototype.name]):{};c.defaults[e]=g(i,a.defaults),c.types[e]=d,c.prototype[e]=function(a,b){var f=h(c.defaults.global,c.defaults[e],b||{});return new d(a,f,this)}}else m("Name not provided for this chart, so it hasn't been registered");return b},c.Element=function(a){g(this,a),this.initialize.apply(this,arguments),this.save()},g(c.Element.prototype,{initialize:function(){},restore:function(a){return a?e(a,function(a){this[a]=this._saved[a]},this):g(this,this._saved),this},save:function(){return this._saved=f(this),delete this._saved._saved,this},update:function(a){return e(a,function(a,b){this._saved[b]=this[b],this[b]=a},this),this},transition:function(a,b){return e(a,function(a,c){this[c]=(a-this._saved[c])*b+this._saved[c]},this),this},tooltipPosition:function(){return{x:this.x,y:this.y}},hasValue:function(){return o(this.value)}}),c.Element.extend=j,c.Point=c.Element.extend({display:!0,inRange:function(a,b){var c=this.hitDetectionRadius+this.radius;return Math.pow(a-this.x,2)+Math.pow(b-this.y,2)<Math.pow(c,2)},draw:function(){if(this.display){var a=this.ctx;a.beginPath(),a.arc(this.x,this.y,this.radius,0,2*Math.PI),a.closePath(),a.strokeStyle=this.strokeColor,a.lineWidth=this.strokeWidth,a.fillStyle=this.fillColor,a.fill(),a.stroke()}}}),c.Arc=c.Element.extend({inRange:function(a,b){var c=d.getAngleFromPoint(this,{x:a,y:b}),e=c.angle>=this.startAngle&&c.angle<=this.endAngle,f=c.distance>=this.innerRadius&&c.distance<=this.outerRadius;return e&&f},tooltipPosition:function(){var a=this.startAngle+(this.endAngle-this.startAngle)/2,b=(this.outerRadius-this.innerRadius)/2+this.innerRadius;return{x:this.x+Math.cos(a)*b,y:this.y+Math.sin(a)*b}},draw:function(a){var b=this.ctx;b.beginPath(),b.arc(this.x,this.y,this.outerRadius,this.startAngle,this.endAngle),b.arc(this.x,this.y,this.innerRadius,this.endAngle,this.startAngle,!0),b.closePath(),b.strokeStyle=this.strokeColor,b.lineWidth=this.strokeWidth,b.fillStyle=this.fillColor,b.fill(),b.lineJoin="bevel",this.showStroke&&b.stroke()}}),c.Rectangle=c.Element.extend({draw:function(){var a=this.ctx,b=this.width/2,c=this.x-b,d=this.x+b,e=this.base-(this.base-this.y),f=this.strokeWidth/2;this.showStroke&&(c+=f,d-=f,e+=f),a.beginPath(),a.fillStyle=this.fillColor,a.strokeStyle=this.strokeColor,a.lineWidth=this.strokeWidth,a.moveTo(c,this.base),a.lineTo(c,e),a.lineTo(d,e),a.lineTo(d,this.base),a.fill(),this.showStroke&&a.stroke()},height:function(){return this.base-this.y},inRange:function(a,b){return a>=this.x-this.width/2&&a<=this.x+this.width/2&&b>=this.y&&b<=this.base}}),c.Tooltip=c.Element.extend({draw:function(){var a=this.chart.ctx;a.font=F(this.fontSize,this.fontStyle,this.fontFamily),this.xAlign="center",this.yAlign="above";var b=2,c=a.measureText(this.text).width+2*this.xPadding,d=this.fontSize+2*this.yPadding,e=d+this.caretHeight+b;this.x+c/2>this.chart.width?this.xAlign="left":this.x-c/2<0&&(this.xAlign="right"),this.y-e<0&&(this.yAlign="below");var f=this.x-c/2,g=this.y-e;switch(a.fillStyle=this.fillColor,this.yAlign){case"above":a.beginPath(),a.moveTo(this.x,this.y-b),a.lineTo(this.x+this.caretHeight,this.y-(b+this.caretHeight)),a.lineTo(this.x-this.caretHeight,this.y-(b+this.caretHeight)),a.closePath(),a.fill();break;case"below":g=this.y+b+this.caretHeight,a.beginPath(),a.moveTo(this.x,this.y+b),a.lineTo(this.x+this.caretHeight,this.y+b+this.caretHeight),a.lineTo(this.x-this.caretHeight,this.y+b+this.caretHeight),a.closePath(),a.fill()}switch(this.xAlign){case"left":f=this.x-c+(this.cornerRadius+this.caretHeight);break;case"right":f=this.x-(this.cornerRadius+this.caretHeight)}H(a,f,g,c,d,this.cornerRadius),a.fill(),a.fillStyle=this.textColor,a.textAlign="center",a.textBaseline="middle",a.fillText(this.text,f+c/2,g+d/2)}}),c.MultiTooltip=c.Element.extend({initialize:function(){this.font=F(this.fontSize,this.fontStyle,this.fontFamily),this.titleFont=F(this.titleFontSize,this.titleFontStyle,this.titleFontFamily),this.height=this.labels.length*this.fontSize+(this.labels.length-1)*(this.fontSize/2)+2*this.yPadding+1.5*this.titleFontSize,this.ctx.font=this.titleFont;var a=this.ctx.measureText(this.title).width,b=G(this.ctx,this.font,this.labels)+this.fontSize+3,c=p([b,a]);this.width=c+2*this.xPadding;var d=this.height/2;this.y-d<0?this.y=d:this.y+d>this.chart.height&&(this.y=this.chart.height-d),this.x>this.chart.width/2?this.x-=this.xOffset+this.width:this.x+=this.xOffset},getLineHeight:function(a){var b=this.y-this.height/2+this.yPadding,c=a-1;return 0===a?b+this.titleFontSize/2:b+(1.5*this.fontSize*c+this.fontSize/2)+1.5*this.titleFontSize},draw:function(){H(this.ctx,this.x,this.y-this.height/2,this.width,this.height,this.cornerRadius);var a=this.ctx;a.fillStyle=this.fillColor,a.fill(),a.closePath(),a.textAlign="left",a.textBaseline="middle",a.fillStyle=this.titleTextColor,a.font=this.titleFont,a.fillText(this.title,this.x+this.xPadding,this.getLineHeight(0)),a.font=this.font,d.each(this.labels,function(b,c){a.fillStyle=this.textColor,a.fillText(b,this.x+this.xPadding+this.fontSize+3,this.getLineHeight(c+1)),a.fillStyle=this.legendColorBackground,a.fillRect(this.x+this.xPadding,this.getLineHeight(c+1)-this.fontSize/2,this.fontSize,this.fontSize),a.fillStyle=this.legendColors[c].fill,a.fillRect(this.x+this.xPadding,this.getLineHeight(c+1)-this.fontSize/2,this.fontSize,this.fontSize)},this)}}),c.Scale=c.Element.extend({initialize:function(){this.fit()},buildYLabels:function(){this.yLabels=[];for(var a=r(this.stepValue),b=0;b<=this.steps;b++)this.yLabels.push(v(this.templateString,{value:(this.min+b*this.stepValue).toFixed(a)}));this.yLabelWidth=this.display&&this.showLabels?G(this.ctx,this.font,this.yLabels):0},addXLabel:function(a){this.xLabels.push(a),this.valuesCount++,this.fit()},removeXLabel:function(){this.xLabels.shift(),this.valuesCount--,this.fit()},fit:function(){this.startPoint=this.display?this.fontSize:0,this.endPoint=this.display?this.height-1.5*this.fontSize-5:this.height,this.startPoint+=this.padding,this.endPoint-=this.padding;var a,b=this.endPoint-this.startPoint;for(this.calculateYRange(b),this.buildYLabels(),this.calculateXLabelRotation();b>this.endPoint-this.startPoint;)b=this.endPoint-this.startPoint,a=this.yLabelWidth,this.calculateYRange(b),this.buildYLabels(),a<this.yLabelWidth&&this.calculateXLabelRotation()},calculateXLabelRotation:function(){this.ctx.font=this.font;var a,b,c=this.ctx.measureText(this.xLabels[0]).width,d=this.ctx.measureText(this.xLabels[this.xLabels.length-1]).width;if(this.xScalePaddingRight=d/2+3,this.xScalePaddingLeft=c/2>this.yLabelWidth+10?c/2:this.yLabelWidth+10,this.xLabelRotation=0,this.display){var e,f=G(this.ctx,this.font,this.xLabels);this.xLabelWidth=f;for(var g=Math.floor(this.calculateX(1)-this.calculateX(0))-6;this.xLabelWidth>g&&0===this.xLabelRotation||this.xLabelWidth>g&&this.xLabelRotation<=90&&this.xLabelRotation>0;)e=Math.cos(s(this.xLabelRotation)),a=e*c,b=e*d,a+this.fontSize/2>this.yLabelWidth+8&&(this.xScalePaddingLeft=a+this.fontSize/2),this.xScalePaddingRight=this.fontSize/2,this.xLabelRotation++,this.xLabelWidth=e*f;this.xLabelRotation>0&&(this.endPoint-=Math.sin(s(this.xLabelRotation))*f+3)}else this.xLabelWidth=0,this.xScalePaddingRight=this.padding,this.xScalePaddingLeft=this.padding},calculateYRange:k,drawingArea:function(){return this.startPoint-this.endPoint},calculateY:function(a){var b=this.drawingArea()/(this.min-this.max);return this.endPoint-b*(a-this.min)},calculateX:function(a){var b=(this.xLabelRotation>0,this.width-(this.xScalePaddingLeft+this.xScalePaddingRight)),c=b/(this.valuesCount-(this.offsetGridLines?0:1)),d=c*a+this.xScalePaddingLeft;return this.offsetGridLines&&(d+=c/2),Math.round(d)},update:function(a){d.extend(this,a),this.fit()},draw:function(){var a=this.ctx,b=(this.endPoint-this.startPoint)/this.steps,c=Math.round(this.xScalePaddingLeft);this.display&&(a.fillStyle=this.textColor,a.font=this.font,e(this.yLabels,function(e,f){var g=this.endPoint-b*f,h=Math.round(g);a.textAlign="right",a.textBaseline="middle",this.showLabels&&a.fillText(e,c-10,g),a.beginPath(),f>0?(a.lineWidth=this.gridLineWidth,a.strokeStyle=this.gridLineColor):(a.lineWidth=this.lineWidth,a.strokeStyle=this.lineColor),h+=d.aliasPixel(a.lineWidth),a.moveTo(c,h),a.lineTo(this.width,h),a.stroke(),a.closePath(),a.lineWidth=this.lineWidth,a.strokeStyle=this.lineColor,a.beginPath(),a.moveTo(c-5,h),a.lineTo(c,h),a.stroke(),a.closePath()},this),e(this.xLabels,function(b,c){var d=this.calculateX(c)+t(this.lineWidth),e=this.calculateX(c-(this.offsetGridLines?.5:0))+t(this.lineWidth),f=this.xLabelRotation>0;a.beginPath(),c>0?(a.lineWidth=this.gridLineWidth,a.strokeStyle=this.gridLineColor):(a.lineWidth=this.lineWidth,a.strokeStyle=this.lineColor),a.moveTo(e,this.endPoint),a.lineTo(e,this.startPoint-3),a.stroke(),a.closePath(),a.lineWidth=this.lineWidth,a.strokeStyle=this.lineColor,a.beginPath(),a.moveTo(e,this.endPoint),a.lineTo(e,this.endPoint+5),a.stroke(),a.closePath(),a.save(),a.translate(d,f?this.endPoint+12:this.endPoint+8),a.rotate(-1*s(this.xLabelRotation)),a.font=this.font,a.textAlign=f?"right":"center",a.textBaseline=f?"middle":"top",a.fillText(b,0,0),a.restore()},this))}}),c.RadialScale=c.Element.extend({initialize:function(){this.size=q([this.height,this.width]),this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2},calculateCenterOffset:function(a){var b=this.drawingArea/(this.max-this.min);return(a-this.min)*b},update:function(){this.lineArc?this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2:this.setScaleSize(),this.buildYLabels()},buildYLabels:function(){this.yLabels=[];for(var a=r(this.stepValue),b=0;b<=this.steps;b++)this.yLabels.push(v(this.templateString,{value:(this.min+b*this.stepValue).toFixed(a)}))},getCircumference:function(){return 2*Math.PI/this.valuesCount},setScaleSize:function(){var a,b,c,d,e,f,g,h,i,j,k,l,m=q([this.height/2-this.pointLabelFontSize-5,this.width/2]),n=this.width,p=0;
for(this.ctx.font=F(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),b=0;b<this.valuesCount;b++)a=this.getPointPosition(b,m),c=this.ctx.measureText(v(this.templateString,{value:this.labels[b]})).width+5,0===b||b===this.valuesCount/2?(d=c/2,a.x+d>n&&(n=a.x+d,e=b),a.x-d<p&&(p=a.x-d,g=b)):b<this.valuesCount/2?a.x+c>n&&(n=a.x+c,e=b):b>this.valuesCount/2&&a.x-c<p&&(p=a.x-c,g=b);i=p,j=Math.ceil(n-this.width),f=this.getIndexAngle(e),h=this.getIndexAngle(g),k=j/Math.sin(f+Math.PI/2),l=i/Math.sin(h+Math.PI/2),k=o(k)?k:0,l=o(l)?l:0,this.drawingArea=m-(l+k)/2,this.setCenterPoint(l,k)},setCenterPoint:function(a,b){var c=this.width-b-this.drawingArea,d=a+this.drawingArea;this.xCenter=(d+c)/2,this.yCenter=this.height/2},getIndexAngle:function(a){var b=2*Math.PI/this.valuesCount;return a*b-Math.PI/2},getPointPosition:function(a,b){var c=this.getIndexAngle(a);return{x:Math.cos(c)*b+this.xCenter,y:Math.sin(c)*b+this.yCenter}},draw:function(){if(this.display){var a=this.ctx;if(e(this.yLabels,function(b,c){if(c>0){var d,e=c*(this.drawingArea/this.steps),f=this.yCenter-e;if(this.lineWidth>0)if(a.strokeStyle=this.lineColor,a.lineWidth=this.lineWidth,this.lineArc)a.beginPath(),a.arc(this.xCenter,this.yCenter,e,0,2*Math.PI),a.closePath(),a.stroke();else{a.beginPath();for(var g=0;g<this.valuesCount;g++)d=this.getPointPosition(g,this.calculateCenterOffset(this.min+c*this.stepValue)),0===g?a.moveTo(d.x,d.y):a.lineTo(d.x,d.y);a.closePath(),a.stroke()}if(this.showLabels){if(a.font=F(this.fontSize,this.fontStyle,this.fontFamily),this.showLabelBackdrop){var h=a.measureText(b).width;a.fillStyle=this.backdropColor,a.fillRect(this.xCenter-h/2-this.backdropPaddingX,f-this.fontSize/2-this.backdropPaddingY,h+2*this.backdropPaddingX,this.fontSize+2*this.backdropPaddingY)}a.textAlign="center",a.textBaseline="middle",a.fillStyle=this.fontColor,a.fillText(b,this.xCenter,f)}}},this),!this.lineArc){a.lineWidth=this.angleLineWidth,a.strokeStyle=this.angleLineColor;for(var b=this.valuesCount-1;b>=0;b--){if(this.angleLineWidth>0){var c=this.getPointPosition(b,this.calculateCenterOffset(this.max));a.beginPath(),a.moveTo(this.xCenter,this.yCenter),a.lineTo(c.x,c.y),a.stroke(),a.closePath()}var d=this.getPointPosition(b,this.calculateCenterOffset(this.max)+5);a.font=F(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),a.fillStyle=this.pointLabelFontColor;var f=this.labels.length,g=this.labels.length/2,h=g/2,i=h>b||b>f-h,j=b===h||b===f-h;a.textAlign=0===b?"center":b===g?"center":g>b?"left":"right",a.textBaseline=j?"middle":i?"bottom":"top",a.fillText(this.labels[b],d.x,d.y)}}}}}),d.addEvent(window,"resize",function(){var a;return function(){clearTimeout(a),a=setTimeout(function(){e(c.instances,function(a){a.options.responsive&&a.resize(a.render,!0)})},50)}}()),n?define(function(){return c}):"object"==typeof module&&module.exports&&(module.exports=c),a.Chart=c,c.noConflict=function(){return a.Chart=b,c}}).call(this),function(){"use strict";var a=this,b=a.Chart,c=b.helpers,d={scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'};b.Type.extend({name:"Bar",defaults:d,initialize:function(a){var d=this.options;this.ScaleClass=b.Scale.extend({offsetGridLines:!0,calculateBarX:function(a,b,c){var e=this.calculateBaseWidth(),f=this.calculateX(c)-e/2,g=this.calculateBarWidth(a);return f+g*b+b*d.barDatasetSpacing+g/2},calculateBaseWidth:function(){return this.calculateX(1)-this.calculateX(0)-2*d.barValueSpacing},calculateBarWidth:function(a){var b=this.calculateBaseWidth()-(a-1)*d.barDatasetSpacing;return b/a}}),this.datasets=[],this.options.showTooltips&&c.bindEvents(this,this.options.tooltipEvents,function(a){var b="mouseout"!==a.type?this.getBarsAtEvent(a):[];this.eachBars(function(a){a.restore(["fillColor","strokeColor"])}),c.each(b,function(a){a.fillColor=a.highlightFill,a.strokeColor=a.highlightStroke}),this.showTooltip(b)}),this.BarClass=b.Rectangle.extend({strokeWidth:this.options.barStrokeWidth,showStroke:this.options.barShowStroke,ctx:this.chart.ctx}),c.each(a.datasets,function(b){var d={label:b.label||null,fillColor:b.fillColor,strokeColor:b.strokeColor,bars:[]};this.datasets.push(d),c.each(b.data,function(c,e){d.bars.push(new this.BarClass({value:c,label:a.labels[e],datasetLabel:b.label,strokeColor:b.strokeColor,fillColor:b.fillColor,highlightFill:b.highlightFill||b.fillColor,highlightStroke:b.highlightStroke||b.strokeColor}))},this)},this),this.buildScale(a.labels),this.BarClass.prototype.base=this.scale.endPoint,this.eachBars(function(a,b,d){c.extend(a,{width:this.scale.calculateBarWidth(this.datasets.length),x:this.scale.calculateBarX(this.datasets.length,d,b),y:this.scale.endPoint}),a.save()},this),this.render()},update:function(){this.scale.update(),c.each(this.activeElements,function(a){a.restore(["fillColor","strokeColor"])}),this.eachBars(function(a){a.save()}),this.render()},eachBars:function(a){c.each(this.datasets,function(b,d){c.each(b.bars,a,this,d)},this)},getBarsAtEvent:function(a){for(var b,d=[],e=c.getRelativePosition(a),f=function(a){d.push(a.bars[b])},g=0;g<this.datasets.length;g++)for(b=0;b<this.datasets[g].bars.length;b++)if(this.datasets[g].bars[b].inRange(e.x,e.y))return c.each(this.datasets,f),d;return d},buildScale:function(a){var b=this,d=function(){var a=[];return b.eachBars(function(b){a.push(b.value)}),a},e={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:a.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(a){var b=c.calculateScaleRange(d(),a,this.fontSize,this.beginAtZero,this.integersOnly);c.extend(this,b)},xLabels:a,font:c.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.barShowStroke?this.options.barStrokeWidth:0,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&c.extend(e,{calculateYRange:c.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}),this.scale=new this.ScaleClass(e)},addData:function(a,b){c.each(a,function(a,c){this.datasets[c].bars.push(new this.BarClass({value:a,label:b,x:this.scale.calculateBarX(this.datasets.length,c,this.scale.valuesCount+1),y:this.scale.endPoint,width:this.scale.calculateBarWidth(this.datasets.length),base:this.scale.endPoint,strokeColor:this.datasets[c].strokeColor,fillColor:this.datasets[c].fillColor}))},this),this.scale.addXLabel(b),this.update()},removeData:function(){this.scale.removeXLabel(),c.each(this.datasets,function(a){a.bars.shift()},this),this.update()},reflow:function(){c.extend(this.BarClass.prototype,{y:this.scale.endPoint,base:this.scale.endPoint});var a=c.extend({height:this.chart.height,width:this.chart.width});this.scale.update(a)},draw:function(a){var b=a||1;this.clear(),this.chart.ctx,this.scale.draw(b),c.each(this.datasets,function(a,d){c.each(a.bars,function(a,c){a.hasValue()&&(a.base=this.scale.endPoint,a.transition({x:this.scale.calculateBarX(this.datasets.length,d,c),y:this.scale.calculateY(a.value),width:this.scale.calculateBarWidth(this.datasets.length)},b).draw())},this)},this)}})}.call(this),function(){"use strict";var a=this,b=a.Chart,c=b.helpers,d={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>'};b.Type.extend({name:"Doughnut",defaults:d,initialize:function(a){this.segments=[],this.outerRadius=(c.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,this.SegmentArc=b.Arc.extend({ctx:this.chart.ctx,x:this.chart.width/2,y:this.chart.height/2}),this.options.showTooltips&&c.bindEvents(this,this.options.tooltipEvents,function(a){var b="mouseout"!==a.type?this.getSegmentsAtEvent(a):[];c.each(this.segments,function(a){a.restore(["fillColor"])}),c.each(b,function(a){a.fillColor=a.highlightColor}),this.showTooltip(b)}),this.calculateTotal(a),c.each(a,function(a,b){this.addData(a,b,!0)},this),this.render()},getSegmentsAtEvent:function(a){var b=[],d=c.getRelativePosition(a);return c.each(this.segments,function(a){a.inRange(d.x,d.y)&&b.push(a)},this),b},addData:function(a,b,c){var d=b||this.segments.length;this.segments.splice(d,0,new this.SegmentArc({value:a.value,outerRadius:this.options.animateScale?0:this.outerRadius,innerRadius:this.options.animateScale?0:this.outerRadius/100*this.options.percentageInnerCutout,fillColor:a.color,highlightColor:a.highlight||a.color,showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,startAngle:1.5*Math.PI,circumference:this.options.animateRotate?0:this.calculateCircumference(a.value),label:a.label})),c||(this.reflow(),this.update())},calculateCircumference:function(a){return 2*Math.PI*(a/this.total)},calculateTotal:function(a){this.total=0,c.each(a,function(a){this.total+=a.value},this)},update:function(){this.calculateTotal(this.segments),c.each(this.activeElements,function(a){a.restore(["fillColor"])}),c.each(this.segments,function(a){a.save()}),this.render()},removeData:function(a){var b=c.isNumber(a)?a:this.segments.length-1;this.segments.splice(b,1),this.reflow(),this.update()},reflow:function(){c.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.outerRadius=(c.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,c.each(this.segments,function(a){a.update({outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout})},this)},draw:function(a){var b=a?a:1;this.clear(),c.each(this.segments,function(a,c){a.transition({circumference:this.calculateCircumference(a.value),outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout},b),a.endAngle=a.startAngle+a.circumference,a.draw(),0===c&&(a.startAngle=1.5*Math.PI),c<this.segments.length-1&&(this.segments[c+1].startAngle=a.endAngle)},this)}}),b.types.Doughnut.extend({name:"Pie",defaults:c.merge(d,{percentageInnerCutout:0})})}.call(this),function(){"use strict";var a=this,b=a.Chart,c=b.helpers,d={scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'};b.Type.extend({name:"Line",defaults:d,initialize:function(a){this.PointClass=b.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx,inRange:function(a){return Math.pow(a-this.x,2)<Math.pow(this.radius+this.hitDetectionRadius,2)}}),this.datasets=[],this.options.showTooltips&&c.bindEvents(this,this.options.tooltipEvents,function(a){var b="mouseout"!==a.type?this.getPointsAtEvent(a):[];this.eachPoints(function(a){a.restore(["fillColor","strokeColor"])}),c.each(b,function(a){a.fillColor=a.highlightFill,a.strokeColor=a.highlightStroke}),this.showTooltip(b)}),c.each(a.datasets,function(b){var d={label:b.label||null,fillColor:b.fillColor,strokeColor:b.strokeColor,pointColor:b.pointColor,pointStrokeColor:b.pointStrokeColor,points:[]};this.datasets.push(d),c.each(b.data,function(c,e){d.points.push(new this.PointClass({value:c,label:a.labels[e],datasetLabel:b.label,strokeColor:b.pointStrokeColor,fillColor:b.pointColor,highlightFill:b.pointHighlightFill||b.pointColor,highlightStroke:b.pointHighlightStroke||b.pointStrokeColor}))},this),this.buildScale(a.labels),this.eachPoints(function(a,b){c.extend(a,{x:this.scale.calculateX(b),y:this.scale.endPoint}),a.save()},this)},this),this.render()},update:function(){this.scale.update(),c.each(this.activeElements,function(a){a.restore(["fillColor","strokeColor"])}),this.eachPoints(function(a){a.save()}),this.render()},eachPoints:function(a){c.each(this.datasets,function(b){c.each(b.points,a,this)},this)},getPointsAtEvent:function(a){var b=[],d=c.getRelativePosition(a);return c.each(this.datasets,function(a){c.each(a.points,function(a){a.inRange(d.x,d.y)&&b.push(a)})},this),b},buildScale:function(a){var d=this,e=function(){var a=[];return d.eachPoints(function(b){a.push(b.value)}),a},f={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:a.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(a){var b=c.calculateScaleRange(e(),a,this.fontSize,this.beginAtZero,this.integersOnly);c.extend(this,b)},xLabels:a,font:c.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.pointDotRadius+this.options.pointDotStrokeWidth,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&c.extend(f,{calculateYRange:c.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}),this.scale=new b.Scale(f)},addData:function(a,b){c.each(a,function(a,c){this.datasets[c].points.push(new this.PointClass({value:a,label:b,x:this.scale.calculateX(this.scale.valuesCount+1),y:this.scale.endPoint,strokeColor:this.datasets[c].pointStrokeColor,fillColor:this.datasets[c].pointColor}))},this),this.scale.addXLabel(b),this.update()},removeData:function(){this.scale.removeXLabel(),c.each(this.datasets,function(a){a.points.shift()},this),this.update()},reflow:function(){var a=c.extend({height:this.chart.height,width:this.chart.width});this.scale.update(a)},draw:function(a){var b=a||1;this.clear();var d=this.chart.ctx,e=function(a){return null!==a.value},f=function(a,b,d){return c.findNextWhere(b,e,d)||a},g=function(a,b,d){return c.findPreviousWhere(b,e,d)||a};this.scale.draw(b),c.each(this.datasets,function(a){var h=c.where(a.points,e);c.each(a.points,function(a,c){a.hasValue()&&a.transition({y:this.scale.calculateY(a.value),x:this.scale.calculateX(c)},b)},this),this.options.bezierCurve&&c.each(h,function(a,b){var d=b>0&&b<h.length-1?this.options.bezierCurveTension:0;a.controlPoints=c.splineCurve(g(a,h,b),a,f(a,h,b),d),a.controlPoints.outer.y>this.scale.endPoint?a.controlPoints.outer.y=this.scale.endPoint:a.controlPoints.outer.y<this.scale.startPoint&&(a.controlPoints.outer.y=this.scale.startPoint),a.controlPoints.inner.y>this.scale.endPoint?a.controlPoints.inner.y=this.scale.endPoint:a.controlPoints.inner.y<this.scale.startPoint&&(a.controlPoints.inner.y=this.scale.startPoint)},this),d.lineWidth=this.options.datasetStrokeWidth,d.strokeStyle=a.strokeColor,d.beginPath(),c.each(h,function(a,b){if(0===b)d.moveTo(a.x,a.y);else if(this.options.bezierCurve){var c=g(a,h,b);d.bezierCurveTo(c.controlPoints.outer.x,c.controlPoints.outer.y,a.controlPoints.inner.x,a.controlPoints.inner.y,a.x,a.y)}else d.lineTo(a.x,a.y)},this),d.stroke(),this.options.datasetFill&&h.length>0&&(d.lineTo(h[h.length-1].x,this.scale.endPoint),d.lineTo(h[0].x,this.scale.endPoint),d.fillStyle=a.fillColor,d.closePath(),d.fill()),c.each(h,function(a){a.draw()})},this)}})}.call(this),function(){"use strict";var a=this,b=a.Chart,c=b.helpers,d={scaleShowLabelBackdrop:!0,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBeginAtZero:!0,scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,scaleShowLine:!0,segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>'};b.Type.extend({name:"PolarArea",defaults:d,initialize:function(a){this.segments=[],this.SegmentArc=b.Arc.extend({showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,ctx:this.chart.ctx,innerRadius:0,x:this.chart.width/2,y:this.chart.height/2}),this.scale=new b.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,lineArc:!0,width:this.chart.width,height:this.chart.height,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,valuesCount:a.length}),this.updateScaleRange(a),this.scale.update(),c.each(a,function(a,b){this.addData(a,b,!0)},this),this.options.showTooltips&&c.bindEvents(this,this.options.tooltipEvents,function(a){var b="mouseout"!==a.type?this.getSegmentsAtEvent(a):[];c.each(this.segments,function(a){a.restore(["fillColor"])}),c.each(b,function(a){a.fillColor=a.highlightColor}),this.showTooltip(b)}),this.render()},getSegmentsAtEvent:function(a){var b=[],d=c.getRelativePosition(a);return c.each(this.segments,function(a){a.inRange(d.x,d.y)&&b.push(a)},this),b},addData:function(a,b,c){var d=b||this.segments.length;this.segments.splice(d,0,new this.SegmentArc({fillColor:a.color,highlightColor:a.highlight||a.color,label:a.label,value:a.value,outerRadius:this.options.animateScale?0:this.scale.calculateCenterOffset(a.value),circumference:this.options.animateRotate?0:this.scale.getCircumference(),startAngle:1.5*Math.PI})),c||(this.reflow(),this.update())},removeData:function(a){var b=c.isNumber(a)?a:this.segments.length-1;this.segments.splice(b,1),this.reflow(),this.update()},calculateTotal:function(a){this.total=0,c.each(a,function(a){this.total+=a.value},this),this.scale.valuesCount=this.segments.length},updateScaleRange:function(a){var b=[];c.each(a,function(a){b.push(a.value)});var d=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:c.calculateScaleRange(b,c.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);c.extend(this.scale,d,{size:c.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2})},update:function(){this.calculateTotal(this.segments),c.each(this.segments,function(a){a.save()}),this.render()},reflow:function(){c.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.updateScaleRange(this.segments),this.scale.update(),c.extend(this.scale,{xCenter:this.chart.width/2,yCenter:this.chart.height/2}),c.each(this.segments,function(a){a.update({outerRadius:this.scale.calculateCenterOffset(a.value)})},this)},draw:function(a){var b=a||1;this.clear(),c.each(this.segments,function(a,c){a.transition({circumference:this.scale.getCircumference(),outerRadius:this.scale.calculateCenterOffset(a.value)},b),a.endAngle=a.startAngle+a.circumference,0===c&&(a.startAngle=1.5*Math.PI),c<this.segments.length-1&&(this.segments[c+1].startAngle=a.endAngle),a.draw()},this),this.scale.draw()}})}.call(this),function(){"use strict";var a=this,b=a.Chart,c=b.helpers;b.Type.extend({name:"Radar",defaults:{scaleShowLine:!0,angleShowLineOut:!0,scaleShowLabels:!1,scaleBeginAtZero:!0,angleLineColor:"rgba(0,0,0,.1)",angleLineWidth:1,pointLabelFontFamily:"'Arial'",pointLabelFontStyle:"normal",pointLabelFontSize:10,pointLabelFontColor:"#666",pointDot:!0,pointDotRadius:3,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'},initialize:function(a){this.PointClass=b.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx}),this.datasets=[],this.buildScale(a),this.options.showTooltips&&c.bindEvents(this,this.options.tooltipEvents,function(a){var b="mouseout"!==a.type?this.getPointsAtEvent(a):[];this.eachPoints(function(a){a.restore(["fillColor","strokeColor"])}),c.each(b,function(a){a.fillColor=a.highlightFill,a.strokeColor=a.highlightStroke}),this.showTooltip(b)}),c.each(a.datasets,function(b){var d={label:b.label||null,fillColor:b.fillColor,strokeColor:b.strokeColor,pointColor:b.pointColor,pointStrokeColor:b.pointStrokeColor,points:[]};this.datasets.push(d),c.each(b.data,function(c,e){var f;this.scale.animation||(f=this.scale.getPointPosition(e,this.scale.calculateCenterOffset(c))),d.points.push(new this.PointClass({value:c,label:a.labels[e],datasetLabel:b.label,x:this.options.animation?this.scale.xCenter:f.x,y:this.options.animation?this.scale.yCenter:f.y,strokeColor:b.pointStrokeColor,fillColor:b.pointColor,highlightFill:b.pointHighlightFill||b.pointColor,highlightStroke:b.pointHighlightStroke||b.pointStrokeColor}))},this)},this),this.render()},eachPoints:function(a){c.each(this.datasets,function(b){c.each(b.points,a,this)},this)},getPointsAtEvent:function(a){var b=c.getRelativePosition(a),d=c.getAngleFromPoint({x:this.scale.xCenter,y:this.scale.yCenter},b),e=2*Math.PI/this.scale.valuesCount,f=Math.round((d.angle-1.5*Math.PI)/e),g=[];return(f>=this.scale.valuesCount||0>f)&&(f=0),d.distance<=this.scale.drawingArea&&c.each(this.datasets,function(a){g.push(a.points[f])}),g},buildScale:function(a){this.scale=new b.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,angleLineColor:this.options.angleLineColor,angleLineWidth:this.options.angleShowLineOut?this.options.angleLineWidth:0,pointLabelFontColor:this.options.pointLabelFontColor,pointLabelFontSize:this.options.pointLabelFontSize,pointLabelFontFamily:this.options.pointLabelFontFamily,pointLabelFontStyle:this.options.pointLabelFontStyle,height:this.chart.height,width:this.chart.width,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,labels:a.labels,valuesCount:a.datasets[0].data.length}),this.scale.setScaleSize(),this.updateScaleRange(a.datasets),this.scale.buildYLabels()},updateScaleRange:function(a){var b=function(){var b=[];return c.each(a,function(a){a.data?b=b.concat(a.data):c.each(a.points,function(a){b.push(a.value)})}),b}(),d=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:c.calculateScaleRange(b,c.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);c.extend(this.scale,d)},addData:function(a,b){this.scale.valuesCount++,c.each(a,function(a,c){var d=this.scale.getPointPosition(this.scale.valuesCount,this.scale.calculateCenterOffset(a));this.datasets[c].points.push(new this.PointClass({value:a,label:b,x:d.x,y:d.y,strokeColor:this.datasets[c].pointStrokeColor,fillColor:this.datasets[c].pointColor}))},this),this.scale.labels.push(b),this.reflow(),this.update()},removeData:function(){this.scale.valuesCount--,this.scale.labels.shift(),c.each(this.datasets,function(a){a.points.shift()},this),this.reflow(),this.update()},update:function(){this.eachPoints(function(a){a.save()}),this.reflow(),this.render()},reflow:function(){c.extend(this.scale,{width:this.chart.width,height:this.chart.height,size:c.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2}),this.updateScaleRange(this.datasets),this.scale.setScaleSize(),this.scale.buildYLabels()},draw:function(a){var b=a||1,d=this.chart.ctx;this.clear(),this.scale.draw(),c.each(this.datasets,function(a){c.each(a.points,function(a,c){a.hasValue()&&a.transition(this.scale.getPointPosition(c,this.scale.calculateCenterOffset(a.value)),b)},this),d.lineWidth=this.options.datasetStrokeWidth,d.strokeStyle=a.strokeColor,d.beginPath(),c.each(a.points,function(a,b){0===b?d.moveTo(a.x,a.y):d.lineTo(a.x,a.y)},this),d.closePath(),d.stroke(),d.fillStyle=a.fillColor,d.fill(),c.each(a.points,function(a){a.hasValue()&&a.draw()})},this)}})}.call(this),function($){$.extend({tablesorter:new function(){function benchmark(a,b){log(a+","+((new Date).getTime()-b.getTime())+"ms")}function log(a){"undefined"!=typeof console&&"undefined"!=typeof console.debug?console.log(a):alert(a)}function buildParserCache(a,b){if(a.config.debug)var c="";if(0!=a.tBodies.length){var d=a.tBodies[0].rows;if(d[0])for(var e=[],f=d[0].cells,g=f.length,h=0;g>h;h++){var i=!1;$.metadata&&$(b[h]).metadata()&&$(b[h]).metadata().sorter?i=getParserById($(b[h]).metadata().sorter):a.config.headers[h]&&a.config.headers[h].sorter&&(i=getParserById(a.config.headers[h].sorter)),i||(i=detectParserForColumn(a,d,-1,h)),a.config.debug&&(c+="column:"+h+" parser:"+i.id+"\n"),e.push(i)}return a.config.debug&&log(c),e}}function detectParserForColumn(a,b,c,d){for(var e=parsers.length,f=!1,g=!1,h=!0;""==g&&h;)c++,b[c]?(f=getNodeFromRowAndCellIndex(b,c,d),g=trimAndGetNodeText(a.config,f),a.config.debug&&log("Checking if value was empty on row:"+c)):h=!1;for(var i=1;e>i;i++)if(parsers[i].is(g,a,f))return parsers[i];return parsers[0]}function getNodeFromRowAndCellIndex(a,b,c){return a[b].cells[c]}function trimAndGetNodeText(a,b){return $.trim(getElementText(a,b))}function getParserById(a){for(var b=parsers.length,c=0;b>c;c++)if(parsers[c].id.toLowerCase()==a.toLowerCase())return parsers[c];return!1}function buildCache(a){if(a.config.debug)var b=new Date;for(var c=a.tBodies[0]&&a.tBodies[0].rows.length||0,d=a.tBodies[0].rows[0]&&a.tBodies[0].rows[0].cells.length||0,e=a.config.parsers,f={row:[],normalized:[]},g=0;c>g;++g){var h=$(a.tBodies[0].rows[g]),i=[];if(h.hasClass(a.config.cssChildRow))f.row[f.row.length-1]=f.row[f.row.length-1].add(h);else{f.row.push(h);for(var j=0;d>j;++j)i.push(e[j].format(getElementText(a.config,h[0].cells[j]),a,h[0].cells[j]));i.push(f.normalized.length),f.normalized.push(i),i=null}}return a.config.debug&&benchmark("Building cache for "+c+" rows:",b),f}function getElementText(a,b){var c="";return b?(a.supportsTextContent||(a.supportsTextContent=b.textContent||!1),c="simple"==a.textExtraction?a.supportsTextContent?b.textContent:b.childNodes[0]&&b.childNodes[0].hasChildNodes()?b.childNodes[0].innerHTML:b.innerHTML:"function"==typeof a.textExtraction?a.textExtraction(b):$(b).text()):""}function appendToTable(a,b){if(a.config.debug)var c=new Date;for(var d=b,e=d.row,f=d.normalized,g=f.length,h=f[0].length-1,i=$(a.tBodies[0]),j=[],k=0;g>k;k++){var l=f[k][h];if(j.push(e[l]),!a.config.appender)for(var m=e[l].length,n=0;m>n;n++)i[0].appendChild(e[l][n])}a.config.appender&&a.config.appender(a,j),j=null,a.config.debug&&benchmark("Rebuilt table:",c),applyWidget(a),setTimeout(function(){$(a).trigger("sortEnd")},0)}function buildHeaders(a){if(a.config.debug)var b=new Date;var c=($.metadata?!0:!1,computeTableHeaderCellIndexes(a));return $tableHeaders=$(a.config.selectorHeaders,a).each(function(b){if(this.column=c[this.parentNode.rowIndex+"-"+this.cellIndex],this.order=formatSortingOrder(a.config.sortInitialOrder),this.count=this.order,(checkHeaderMetadata(this)||checkHeaderOptions(a,b))&&(this.sortDisabled=!0),checkHeaderOptionsSortingLocked(a,b)&&(this.order=this.lockedOrder=checkHeaderOptionsSortingLocked(a,b)),!this.sortDisabled){var d=$(this).addClass(a.config.cssHeader);a.config.onRenderHeader&&a.config.onRenderHeader.apply(d)}a.config.headerList[b]=this}),a.config.debug&&(benchmark("Built headers:",b),log($tableHeaders)),$tableHeaders}function computeTableHeaderCellIndexes(a){for(var b=[],c={},d=a.getElementsByTagName("THEAD")[0],e=d.getElementsByTagName("TR"),f=0;f<e.length;f++)for(var g=e[f].cells,h=0;h<g.length;h++){var i,j=g[h],k=j.parentNode.rowIndex,l=k+"-"+j.cellIndex,m=j.rowSpan||1,n=j.colSpan||1;"undefined"==typeof b[k]&&(b[k]=[]);for(var o=0;o<b[k].length+1;o++)if("undefined"==typeof b[k][o]){i=o;break}c[l]=i;for(var o=k;k+m>o;o++){"undefined"==typeof b[o]&&(b[o]=[]);for(var p=b[o],q=i;i+n>q;q++)p[q]="x"}}return c}function checkCellColSpan(a,b,c){for(var d=[],e=a.tHead.rows,f=e[c].cells,g=0;g<f.length;g++){var h=f[g];h.colSpan>1?d=d.concat(checkCellColSpan(a,headerArr,c++)):(1==a.tHead.length||h.rowSpan>1||!e[c+1])&&d.push(h)}return d}function checkHeaderMetadata(a){return $.metadata&&$(a).metadata().sorter===!1?!0:!1}function checkHeaderOptions(a,b){return a.config.headers[b]&&a.config.headers[b].sorter===!1?!0:!1}function checkHeaderOptionsSortingLocked(a,b){return a.config.headers[b]&&a.config.headers[b].lockedOrder?a.config.headers[b].lockedOrder:!1}function applyWidget(a){for(var b=a.config.widgets,c=b.length,d=0;c>d;d++)getWidgetById(b[d]).format(a)}function getWidgetById(a){for(var b=widgets.length,c=0;b>c;c++)if(widgets[c].id.toLowerCase()==a.toLowerCase())return widgets[c]}function formatSortingOrder(a){return"Number"!=typeof a?"desc"==a.toLowerCase()?1:0:1==a?1:0}function isValueInArray(a,b){for(var c=b.length,d=0;c>d;d++)if(b[d][0]==a)return!0;return!1}function setHeadersCss(a,b,c,d){b.removeClass(d[0]).removeClass(d[1]);
var e=[];b.each(function(a){this.sortDisabled||(e[this.column]=$(this))});for(var f=c.length,g=0;f>g;g++)e[c[g][0]].addClass(d[c[g][1]])}function fixColumnWidth(a,b){var c=a.config;if(c.widthFixed){var d=$("<colgroup>");$("tr:first td",a.tBodies[0]).each(function(){d.append($("<col>").css("width",$(this).width()))}),$(a).prepend(d)}}function updateHeaderSortCount(a,b){for(var c=a.config,d=b.length,e=0;d>e;e++){var f=b[e],g=c.headerList[f[0]];g.count=f[1],g.count++}}function multisort(table,sortList,cache){if(table.config.debug)var sortTime=new Date;for(var dynamicExp="var sortWrapper = function(a,b) {",l=sortList.length,i=0;l>i;i++){var c=sortList[i][0],order=sortList[i][1],s="text"==table.config.parsers[c].type?0==order?makeSortFunction("text","asc",c):makeSortFunction("text","desc",c):0==order?makeSortFunction("numeric","asc",c):makeSortFunction("numeric","desc",c),e="e"+i;dynamicExp+="var "+e+" = "+s,dynamicExp+="if("+e+") { return "+e+"; } ",dynamicExp+="else { "}var orgOrderCol=cache.normalized[0].length-1;dynamicExp+="return a["+orgOrderCol+"]-b["+orgOrderCol+"];";for(var i=0;l>i;i++)dynamicExp+="}; ";return dynamicExp+="return 0; ",dynamicExp+="}; ",table.config.debug&&benchmark("Evaling expression:"+dynamicExp,new Date),eval(dynamicExp),cache.normalized.sort(sortWrapper),table.config.debug&&benchmark("Sorting on "+sortList.toString()+" and dir "+order+" time:",sortTime),cache}function makeSortFunction(a,b,c){var d="a["+c+"]",e="b["+c+"]";return"text"==a&&"asc"==b?"("+d+" == "+e+" ? 0 : ("+d+" === null ? Number.POSITIVE_INFINITY : ("+e+" === null ? Number.NEGATIVE_INFINITY : ("+d+" < "+e+") ? -1 : 1 )));":"text"==a&&"desc"==b?"("+d+" == "+e+" ? 0 : ("+d+" === null ? Number.POSITIVE_INFINITY : ("+e+" === null ? Number.NEGATIVE_INFINITY : ("+e+" < "+d+") ? -1 : 1 )));":"numeric"==a&&"asc"==b?"("+d+" === null && "+e+" === null) ? 0 :("+d+" === null ? Number.POSITIVE_INFINITY : ("+e+" === null ? Number.NEGATIVE_INFINITY : "+d+" - "+e+"));":"numeric"==a&&"desc"==b?"("+d+" === null && "+e+" === null) ? 0 :("+d+" === null ? Number.POSITIVE_INFINITY : ("+e+" === null ? Number.NEGATIVE_INFINITY : "+e+" - "+d+"));":void 0}function makeSortText(a){return"((a["+a+"] < b["+a+"]) ? -1 : ((a["+a+"] > b["+a+"]) ? 1 : 0));"}function makeSortTextDesc(a){return"((b["+a+"] < a["+a+"]) ? -1 : ((b["+a+"] > a["+a+"]) ? 1 : 0));"}function makeSortNumeric(a){return"a["+a+"]-b["+a+"];"}function makeSortNumericDesc(a){return"b["+a+"]-a["+a+"];"}function sortText(a,b){return table.config.sortLocaleCompare?a.localeCompare(b):b>a?-1:a>b?1:0}function sortTextDesc(a,b){return table.config.sortLocaleCompare?b.localeCompare(a):a>b?-1:b>a?1:0}function sortNumeric(a,b){return a-b}function sortNumericDesc(a,b){return b-a}function getCachedSortType(a,b){return a[b].type}var parsers=[],widgets=[];this.defaults={cssHeader:"table-header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",cssChildRow:"expand-child",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,sortLocaleCompare:!0,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:!1,cancelSelection:!0,sortList:[],headerList:[],dateFormat:"us",decimal:"/.|,/g",onRenderHeader:null,selectorHeaders:"thead th",debug:!1},this.benchmark=benchmark,this.construct=function(a){return this.each(function(){if(this.tHead&&this.tBodies){var b,c,d,e;this.config={},e=$.extend(this.config,$.tablesorter.defaults,a),b=$(this),$.data(this,"tablesorter",e),c=buildHeaders(this),this.config.parsers=buildParserCache(this,c),d=buildCache(this);var f=[e.cssDesc,e.cssAsc];fixColumnWidth(this),c.click(function(a){var g=b[0].tBodies[0]&&b[0].tBodies[0].rows.length||0;if(!this.sortDisabled&&g>0){b.trigger("sortStart");var h=($(this),this.column);if(this.order=this.count++%2,this.lockedOrder&&(this.order=this.lockedOrder),a[e.sortMultiSortKey])if(isValueInArray(h,e.sortList))for(var i=0;i<e.sortList.length;i++){var j=e.sortList[i],k=e.headerList[j[0]];j[0]==h&&(k.count=j[1],k.count++,j[1]=k.count%2)}else e.sortList.push([h,this.order]);else{if(e.sortList=[],null!=e.sortForce)for(var l=e.sortForce,i=0;i<l.length;i++)l[i][0]!=h&&e.sortList.push(l[i]);e.sortList.push([h,this.order])}return setTimeout(function(){setHeadersCss(b[0],c,e.sortList,f),appendToTable(b[0],multisort(b[0],e.sortList,d))},1),!1}}).mousedown(function(){return e.cancelSelection?(this.onselectstart=function(){return!1},!1):void 0}),b.bind("update",function(){var a=this;setTimeout(function(){a.config.parsers=buildParserCache(a,c),d=buildCache(a)},1)}).bind("updateCell",function(a,b){var c=this.config,e=[b.parentNode.rowIndex-1,b.cellIndex];d.normalized[e[0]][e[1]]=c.parsers[e[1]].format(getElementText(c,b),b)}).bind("sorton",function(a,b){$(this).trigger("sortStart"),e.sortList=b;var g=e.sortList;updateHeaderSortCount(this,g),setHeadersCss(this,c,g,f),appendToTable(this,multisort(this,g,d))}).bind("appendCache",function(){appendToTable(this,d)}).bind("applyWidgetId",function(a,b){getWidgetById(b).format(this)}).bind("applyWidgets",function(){applyWidget(this)}),$.metadata&&$(this).metadata()&&$(this).metadata().sortlist&&(e.sortList=$(this).metadata().sortlist),e.sortList.length>0&&b.trigger("sorton",[e.sortList]),applyWidget(this)}})},this.addParser=function(a){for(var b=parsers.length,c=!0,d=0;b>d;d++)parsers[d].id.toLowerCase()==a.id.toLowerCase()&&(c=!1);c&&parsers.push(a)},this.addWidget=function(a){widgets.push(a)},this.formatFloat=function(a){var b=parseFloat(a);return isNaN(b)?0:b},this.formatInt=function(a){var b=parseInt(a);return isNaN(b)?0:b},this.isDigit=function(a,b){return/^[-+]?\d*$/.test($.trim(a.replace(/[,.']/g,"")))},this.clearTableBody=function(a){function b(){for(;this.firstChild;)this.removeChild(this.firstChild)}$.browser.msie?b.apply(a.tBodies[0]):a.tBodies[0].innerHTML=""}}}),$.fn.extend({tablesorter:$.tablesorter.construct});var ts=$.tablesorter;ts.addParser({id:"text",is:function(a){return!0},format:function(a){return $.trim(a.toLocaleLowerCase())},type:"text"}),ts.addParser({id:"digit",is:function(a,b){var c=b.config;return $.tablesorter.isDigit(a,c)},format:function(a){return $.tablesorter.formatFloat(a)},type:"numeric"}),ts.addParser({id:"currency",is:function(a){return/^[$?.]/.test(a)},format:function(a){return $.tablesorter.formatFloat(a.replace(new RegExp(/[$]/g),""))},type:"numeric"}),ts.addParser({id:"ipAddress",is:function(a){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(a)},format:function(a){for(var b=a.split("."),c="",d=b.length,e=0;d>e;e++){var f=b[e];c+=2==f.length?"0"+f:f}return $.tablesorter.formatFloat(c)},type:"numeric"}),ts.addParser({id:"url",is:function(a){return/^(https?|ftp|file):\/\/$/.test(a)},format:function(a){return jQuery.trim(a.replace(new RegExp(/(https?|ftp|file):\/\//),""))},type:"text"}),ts.addParser({id:"isoDate",is:function(a){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(a)},format:function(a){return $.tablesorter.formatFloat(""!=a?new Date(a.replace(new RegExp(/-/g),"/")).getTime():"0")},type:"numeric"}),ts.addParser({id:"percent",is:function(a){return/\%$/.test($.trim(a))},format:function(a){return $.tablesorter.formatFloat(a.replace(new RegExp(/%/g),""))},type:"numeric"}),ts.addParser({id:"usLongDate",is:function(a){return a.match(new RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/))},format:function(a){return $.tablesorter.formatFloat(new Date(a).getTime())},type:"numeric"}),ts.addParser({id:"shortDate",is:function(a){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(a)},format:function(a,b){var c=b.config;return a=a.replace(/\-/g,"/"),"us"==c.dateFormat?a=a.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2"):"uk"==c.dateFormat?a=a.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1"):("dd/mm/yy"==c.dateFormat||"dd-mm-yy"==c.dateFormat)&&(a=a.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3")),$.tablesorter.formatFloat(new Date(a).getTime())},type:"numeric"}),ts.addParser({id:"time",is:function(a){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(a)},format:function(a){return $.tablesorter.formatFloat(new Date("2000/01/01 "+a).getTime())},type:"numeric"}),ts.addParser({id:"metadata",is:function(a){return!1},format:function(a,b,c){var d=b.config,e=d.parserMetadataName?d.parserMetadataName:"sortValue";return $(c).metadata()[e]},type:"numeric"}),ts.addWidget({id:"zebra",format:function(a){if(a.config.debug)var b=new Date;var c,d,e=-1;$("tr:visible",a.tBodies[0]).each(function(b){c=$(this),c.hasClass(a.config.cssChildRow)||e++,d=e%2==0,c.removeClass(a.config.widgetZebra.css[d?0:1]).addClass(a.config.widgetZebra.css[d?1:0])}),a.config.debug&&$.tablesorter.benchmark("Applying Zebra widget",b)}})}(jQuery),function(a){"use strict";var b=a({});a.subscribe=function(){b.on.apply(b,arguments)},a.unsubscribe=function(){b.off.apply(b,arguments)},a.publish=function(){b.trigger.apply(b,arguments)}}(jQuery);var FB=FB||{},FBRun=FBRun||{};!function(a){"use strict";a.Calculon=function(a){this.init(a)}}(jQuery),jQuery.support.cors=!0,$.Calculon.prototype={defaults:{url:"http://calculon.olmdemo.co.uk/calc/ws/calcService.cfc?method=calculate",proxy:"/ServiceHandlers/GenericHandler.ashx",successUrl:"",model:"",formContainer:$(".form-fb")},init:function(a){"use strict";var b=this;return b.request="",b.response="",b.status="",b.responseTime=0,b.results=[],b.options=$.extend({},b.defaults,a),b},update:function(a){"use strict";var b=this;return b.options=$.extend({},b.defaults,a),b},time:function(){"use strict";return(new Date).getTime()},duration:function(a,b){"use strict";var c=(b-a)/1e3;return c},validateElement:function(a){"use strict";var b=["__","ctl00","ddlViewPort","txtKeyWord","txtFeedback","hidOrganisationId","hidUserId","hidEktronId"],c=!0,d=a.attr("id");return void 0!==d&&$.each(b,function(a,b){d.indexOf(b)>-1&&(c=!1)}),c},getInputs:function(){"use strict";var a=this,b=[],c=$("input[type!=submit], select, textarea, .table-group",a.options.formContainer);return $.each(c,function(){var c,d,e;if(d=void 0!==$(this).prop("type")?$(this).prop("type"):"",$(this).hasClass("table-group")&&(d="tablegroup"),a.validateElement($(this))){var f=$(this).attr("id"),g=$(this).attr("name");if("tablegroup"===d)c=FBRun.tablegroup.getData($(this)),g=f,e=$(this).data("idcol");else if(void 0!==g){var h=g.indexOf("$")>-1?"":$.trim($("label[for="+g+"]").text());switch(h=h.replace(" *",""),d){case"radio":(0===b.length||b[b.length-1].name!==g)&&(c=$("input[name="+g+"]:checked").val(),void 0===c&&(c=""));break;case"checkbox":if(0===b.length||b[b.length-1].name!==g){var i=[];$.each($("input[name="+g+"]:checked"),function(){i.push($(this).val())}),c=""}break;default:c=$(this).val()}}void 0!==c&&($.isArray($(this).val())?b.push({id:f,type:d,name:g,label:h,val:c,array:!0}):void 0!==e?b.push({id:f,type:d,name:g,label:h,val:c,idcol:e}):b.push({id:f,type:d,name:g,label:h,val:c}))}}),b},validRow:function(a){"use strict";var b=!1;return $.each(a,function(a,c){void 0===c&&(c=""),""!==c&&0!==parseInt(c)&&(b=!0)}),b},convertTableDataToCalculon:function(a,b){"use strict";void 0===b&&(b=!1);var c=0;b&&(c=1);var d=JSON.parse(a),e="";return $.each(d.data,function(a,b){$.each(b,function(b,f){if(""!==f){var g=d.name+"-r"+(a+1)+"-c"+(b+c);e+='"'+g+'":"'+f+'",'}})}),e},convertCalculonToTableData:function(a){"use strict";var b=this,c=[],d=[],e=1,f=0;return $.each(a,function(a,g){a>0&&e!==g[3]&&(b.validRow(d)&&c.push(d),d=[]),g[4]>=f&&(d[g[4]]=g[1]),e=g[3]}),b.validRow(d)&&c.push(d),{name:a[0][0],val:c,type:"table"}},parseInputs:function(){"use strict";var a=this,b="",c=a.getInputs();return $.each(c,function(d,e){if("tablegroup"===e.type)b+="hhin"===e.id?a.convertTableDataToCalculon(e.val,!0):a.convertTableDataToCalculon(e.val);else if(""!==e.val&&null!==e.val){var f=e.id;("radio"===e.type||"checkbox"===e.type)&&(f=e.name),b+='"'+f+'" : "'+e.val+'"',d<c.length-1&&(b+=",")}}),b},parseTableKey:function(a,b){"use strict";for(var c=a.split("-"),d=c.length,e=parseInt(c[d-1].substring(1)),f=parseInt(c[d-2].substring(1)),g="",h=0;d-2>h;h++)g+=c[h];return[g,b,"table",f,e]},sortResponse:function(a){"use strict";var b=this,c=[];$.each(a,function(a,d){a.indexOf("-r")>-1&&a.indexOf("-c")>-1?c.push(b.parseTableKey(a,d)):c.push([$.trim(a),$.trim(d),""])});var d=[],e=[];$.each(c,function(a,b){"table"===b[2]&&(d.push(b),e.push(b[0]))});var f=e.filter(function(a,b,c){return b==c.indexOf(a)}),g=[];$.each(f,function(a,c){var e=$.grep(d,function(a,b){return a[0]==c});e.sort(function(a,b){var c=a[3],d=b[3];return d>c?-1:c>d?1:0});var f=1,h=[],i=[];$.each(e,function(a,b){b[3]==f?h.push(b):(f=b[3],h.sort(function(a,b){var c=a[4],d=b[4];return d>c?-1:c>d?1:0}),i=i.concat(h),h=[],h.push(b))}),h.sort(function(a,b){var c=a[4],d=b[4];return d>c?-1:c>d?1:0}),i=i.concat(h),g.push(b.convertCalculonToTableData(i))});var h=[];return $.map(c,function(a,b){"table"!=a[2]&&h.push(a)}),h.sort(),$.each(h,function(a,b){g.push({name:b[0],val:b[1],type:""})}),g},writeResponse:function(a,b){"use strict";var c=this,d=JSON.parse(a),e=c.sortResponse(d);return $.each(e,function(a,b){$.each($("[id="+b.name+"]"),function(){"table"===b.type?0===b.val.length?console.log("Error writing table: "+b.name+" is empty."):FBRun.tablegroup.setData($(this),b.val):$(this).val(b.val)})}),void 0!==b&&b(),!1},writeError:function(a){"use strict";var b=this;return void 0!==a?bootbox.alert(a):bootbox.alert("There was an error communicating with the calculation service."),b},send:function(a){"use strict";var b=this,c=b.time();FB.utils.showSpinner();var d=""!==b.options.proxy?b.options.proxy+"?url="+encodeURIComponent(b.options.url):b.options.url,e=$.ajax({type:"POST",url:d,data:b.request,dataType:"json",success:function(d){b.responseTime=b.duration(c,b.time()),b.status="Success";var f=void 0!==e?e.responseText:JSON.stringify(d);b.response=f,FB.utils.hideSpinner(),b.writeResponse(b.response,a),""!==b.options.successUrl&&(window.location=b.options.successUrl)},error:function(a){b.responseTime=b.duration(c,b.time()),b.status="Error",b.response=a.message,FB.utils.hideSpinner(),b.writeError(b.response)},fail:function(a){b.responseTime=b.duration(c,b.time()),b.status="Fail",b.response=a.message,FB.utils.hideSpinner(),b.writeError(b.response)}});return b},calculate:function(a,b){"use strict";var c=this;void 0!==a&&c.update(a);var d=!0;""===c.options.model&&(d=!1,console.log("Calculation model not defined")),c.request='{"workbookname": "'+c.options.model+'", "inputs": {'+c.parseInputs()+"}}",d&&(void 0!==b?c.send(b):c.send())}};var calc=new $.Calculon,FB=FB||{},FBRun=FBRun||{};!function(a){"use strict";a.Calculon2=function(a){this.init(a)}}(jQuery),jQuery.support.cors=!0,$.Calculon2.prototype={defaults:{user:"airburst8+salesdesigner@gmail.com",pass:"C0mmun1c8#R",url:"https://46.245.248.9/calcengine/rest/rasCalculation",proxy:"/ServiceHandlers/GenericHandler.ashx",successUrl:"",model:"Test",environment:"Test",formContainer:$(".form-fb")},init:function(a){"use strict";var b=this;return b.request="",b.response="",b.status="",b.responseTime=0,b.results=[],b.options=$.extend({},b.defaults,a),b},update:function(a){"use strict";var b=this;return b.options=$.extend({},b.defaults,a),b},time:function(){"use strict";return(new Date).getTime()},duration:function(a,b){"use strict";var c=(b-a)/1e3;return c},validateElement:function(a){"use strict";var b=["__","ctl00","ddlViewPort","txtKeyWord","txtFeedback","hidOrganisationId","hidUserId","hidEktronId"],c=!0,d=a.attr("id");return void 0!==d&&$.each(b,function(a,b){d.indexOf(b)>-1&&(c=!1)}),c},getInputs:function(){"use strict";var a,b,c,d,e,f,g,h=this,i=[],j=$("input[type!=submit], select, textarea, .table-group",h.options.formContainer);return $.each(j,function(){if(b=void 0!==$(this).prop("type")?$(this).prop("type"):"",$(this).hasClass("table-group")&&(b="tablegroup"),h.validateElement($(this))){if(d=$(this).attr("id"),e=$(this).attr("name"),"tablegroup"===b)a=FBRun.tablegroup.getData($(this)),e=d,c=$(this).data("idcol");else if(void 0!==e)switch(g=e.indexOf("$")>-1?"":$.trim($("label[for="+e+"]").text()),g=g.replace(" *",""),b){case"radio":(0===i.length||i[i.length-1].name!==e)&&(a=$("input[name="+e+"]:checked").val(),void 0===a&&(a=""));break;case"checkbox":(0===i.length||i[i.length-1].name!==e)&&(f=[],$.each($("input[name="+e+"]:checked"),function(){f.push($(this).val())}),a="");break;default:a=$(this).val()}void 0!==a&&($.isArray($(this).val())?i.push({id:d,type:b,name:e,label:g,val:a,array:!0}):void 0!==c?i.push({id:d,type:b,name:e,label:g,val:a,idcol:c}):i.push({id:d,type:b,name:e,label:g,val:a}))}}),i},validRow:function(a){"use strict";var b=!1;return a.forEach(function(a){void 0===a&&(a=""),""!==a&&0!==parseInt(a,10)&&(b=!0)}),b},convertTableDataToCalculon:function(a,b){"use strict";void 0===b&&(b=!1);var c=JSON.parse(a),d='{"_type":"NewTableCalculationParameter", "name":"'+c.name+'",',e=[];return b?d+='"data":'+JSON.stringify(c.data)+"}":(e=[],$.each(c.data,function(a,b){b.splice(0,1),e.push(b)}),d+='"data":'+JSON.stringify(e)+"}"),d},convertCalculonToTableData:function(a){"use strict";var b=this,c=[],d=[],e=1,f=0;return $.each(a,function(a,g){a>0&&e!==g[3]&&(b.validRow(d)&&c.push(d),d=[]),g[4]>=f&&(d[g[4]]=g[1]),e=g[3]}),b.validRow(d)&&c.push(d),{name:a[0][0],val:c,type:"table"}},createRequest:function(){"use strict";var a,b=this,c="",d=b.getInputs();return $.each(d,function(e,f){if("tablegroup"===f.type){var g=void 0!==f.idcol?!0:!1;c+=b.convertTableDataToCalculon(f.val,g),e<d.length-1&&(c+=",")}else""!==f.val&&null!==f.val&&(a=f.id,("radio"===f.type||"checkbox"===f.type)&&(a=f.name),c+='{"_type": "NewScalarCalculationParameter",',c+='"name":"'+a+'",',c+='"value":"'+f.val+'"}',e<d.length-1&&(c+=","))}),","===c.charAt(c.length-1)&&(c=c.substring(0,c.length-1)),c},sortResponse:function(a){"use strict";var b=[];return $.each(a,function(a,c){"TableCalculationParameter"===c._type?b.push({name:c.name,val:c.data,type:"table"}):b.push({name:$.trim(c.name),val:$.trim(c.value),type:""})}),b},writeResponse:function(a){"use strict";var b,c,d=this;return d.results.push({status:d.status,req:d.request,res:d.response,time:d.responseTime}),b=JSON.parse(a),c=d.sortResponse(b.outputValues),$.each(c,function(a,b){var c=$("[id="+b.name+"]");"table"===b.type?b.val.length>0&&FBRun.tablegroup.setData(c,b.val):c.val(b.val)}),d},writeError:function(a){"use strict";var b,c,d=this;return d.results.push({status:d.status,req:d.request,res:d.response,time:d.responseTime}),b=JSON.parse(a),c=d.status+"\n\nError Type: "+b.type+"\n\nError Code: "+b.code+"\n\nDetails:\n"+b.developerMessage,bootbox.alert(c),d},send:function(a){"use strict";var b,c,d,e=this,f=e.time();return FB.utils.showSpinner(),b=e.options.url+"?calcEnvironmentName="+e.options.environment+"&modelName="+e.options.model,c=""!==e.options.proxy?e.options.proxy+"?url="+encodeURIComponent(b):b,d=$.ajax({type:"POST",url:c,data:e.request,headers:{Authorization:"Basic "+window.btoa(e.options.user+":"+e.options.pass)},dataType:"json",contentType:"application/json",async:!1,success:function(b){e.responseTime=e.duration(f,e.time()),e.status="Success";var c=void 0!==d?d.responseText:JSON.stringify(b);e.response=c,FB.utils.hideSpinner(),e.writeResponse(e.response),void 0!==a&&a(),""!==e.options.successUrl&&(window.location=e.options.successUrl)},error:function(a){e.responseTime=e.duration(f,e.time()),e.status="Error",e.response=a.message,FB.utils.hideSpinner(),e.writeError(e.response)},fail:function(a){e.responseTime=e.duration(f,e.time()),e.status="Fail",e.response=a.message,FB.utils.hideSpinner(),e.writeError(e.response)}}),e},calculate:function(a,b){"use strict";var c=this,d=!0,e="";void 0!==a&&c.update(a),""===c.options.model?(d=!1,console.log("Calculation model not defined")):(e='{"_type": "NewRasRequest",',e+='"rasModelVO": {"_type":"NewRasModel","modelVersionId": 0},',e+='"inputValues": ['+c.createRequest()+"]}",c.request=e,d&&(void 0!==b?c.send(b):c.send()))}};var calc2=new $.Calculon2,FB=FB||{},FBRun=FBRun||{};!function(a){"use strict";a.LocalStorage=function(a){this.init(a)}}(jQuery),jQuery.support.cors=!0,$.LocalStorage.prototype={defaults:{url:"http://apiv32.mylifetest.co.uk/api/forms",proxy:"/ServiceHandlers/GenericHandler.ashx",formName:"General Enquiry",description:"",successUrl:"",orgId:$("#hidOrganisationId").val()||"",userId:$("#hidUserId").val()||0,formContainer:$(".form-fb"),successMessage:"Your information has been saved.  Thank you for completing this form.",errorMessage:"There is a problem and we are unable to save your information.  Please contact us and we will resolve this issue.",failMessage:"There is a problem and we are unable to save your information.  Please contact us and we will resolve this issue.",messageTitle:"Thank you",taskUrl:"/Secure/Account/TaskHandler.ashx",userGuid:$("#hidMembershipId").val()||"",hubId:$("#hubId").val()||""},init:function(a){"use strict";var b=this;return void 0!==$("#webApiUrl").val()&&(b.defaults.url=$("#webApiUrl").val()),b.options=$.extend({},b.defaults,a),b},validateElement:function(a){"use strict";var b=["__","ctl00","ddlViewPort","txtKeyWord","txtFeedback","hidOrganisationId","hidUserId","hidEktronId","hidMembershipId","webApiUrl","hidContactEmail","hubId"],c=!0,d=a.attr("id");return void 0!==d&&$.each(b,function(a,b){d.indexOf(b)>-1&&(c=!1)}),c},getInputs:function(){"use strict";var a=this,b=[],c=$("input[type!=submit], select, textarea, .table-group",a.options.formContainer);return $.each(c,function(){var c,d,e,f,g,h,i;if(e=void 0!==$(this).prop("type")?$(this).prop("type"):"",$(this).hasClass("table-group")&&(e="tablegroup"),a.validateElement($(this))){if(g=$(this).attr("id"),h=$(this).attr("name"),i=$(this).closest("[data-id]").attr("data-integration"),"tablegroup"===e)c=FBRun.tablegroup.getData($(this)),d=c,h=g,f=$(this).data("idcol");else if(void 0!==h){var j=h.indexOf("$")>-1?"":$.trim($("label[for="+h+"]").text());switch(j=j.replace(" *",""),e){case"radio":(0===b.length||b[b.length-1].name!==h)&&(c=$("input[name='"+h+"']:checked").val(),void 0===c&&(c=""),d=$.trim($("input[name='"+h+"']:checked").closest("label").text()),void 0===d&&(d=""));break;case"checkbox":if(0===b.length||b[b.length-1].name!==h){var k=[],l=[];$.each($("input[name='"+h+"']:checked"),function(){k.push($(this).val()),l.push($.trim($("input[name='"+h+"']:checked").closest("label").text()))}),c=JSON.stringify(k),d=JSON.stringify(l)}break;case"select-one":c=$(this).val(),d=""===c?"":$("option[value='"+c+"']",$(this)).text();break;default:c=$(this).val(),d=c}}if(void 0!==c)if($.isArray($(this).val()))b.push({id:g,type:e,name:h,label:j,text:d,val:c,array:!0});else{var m={id:g,type:e,name:h,label:j,text:d,val:c};void 0!==f&&$.extend(m,{idcol:f}),void 0!==i&&($.extend(m,{integration:i}),("radio"===e||"select-one"===e||"checkbox"===e)&&$.extend(m,{code:c})),b.push(m)}}}),b},parseInputs:function(){"use strict";var a=this,b=[],c=a.getInputs();return $.each(c,function(a,c){var d,e="radio"===c.type||"checkbox"===c.type?c.name:c.id;d=""!==c.label?{Id:e,Label:c.label,Text:c.text,Value:c.val}:{Id:e,Label:c.name,Text:c.text,Value:c.val},c.integration&&$.extend(d,{Integration:c.integration}),c.code&&$.extend(d,{Code:c.code}),b.push(d)}),JSON.stringify(b)},closeTask:function(a,b){"use strict";var c=this;if(""!=b&&""!=a)var d={taskId:a,status:"3",userId:b},e=$.ajax({url:c.options.taskUrl,type:"POST",data:JSON.stringify(d),dataType:"json",success:function(){""==c.options.successUrl&&(window.location=document.referrer)},error:function(a){var b=void 0!==e?e.responseText:a.statusText;bootbox.alert("Error\n\n"+b)},fail:function(a){var b=void 0!==e?e.responseText:a.statusText;bootbox.alert("Communication Failure\n\n"+b)}})},writeBack:function(a,b,c){"use strict";var d=this,e="";switch(b){case"Error":e=d.options.errorMessage;break;case"Fail":e=d.options.failMessage;break;case"Success":e=d.options.successMessage;var f=FB.utils.getUrlParameter("taskid");""!=f&&d.closeTask(f,d.options.userGuid)}return FB.utils.hideSpinner(),window.bootbox.dialog({message:e,title:d.options.messageTitle,buttons:{success:{label:"OK",className:"btn-success",callback:function(){void 0!==c?c():""!==d.options.successUrl&&(window.location=d.options.successUrl)}}}}),d},store:function(a,b){"use strict";var c=this;void 0!==a&&c.init(a),FB.utils.showSpinner();var d=c.parseInputs(),e={OrganisationId:c.options.orgId,FormName:c.options.formName,Description:c.options.description,UserId:void 0!==c.options.userId?c.options.userId:0,HubId:c.options.hubId,Data:d},f=""!==c.options.proxy?c.options.proxy+"?url="+encodeURIComponent(c.options.url):c.options.url,g=$.ajax({type:"POST",url:f,data:e,dataType:"json",success:function(a){FB.utils.hideSpinner();var d=void 0!==g?g.responseText:a;c.writeBack(d,"Success",b)},error:function(a){FB.utils.hideSpinner(),c.writeBack(a.statusText,"Error")},fail:function(a){FB.utils.hideSpinner(),c.writeBack(a.statusText,"Fail")}})}};var ls=new $.LocalStorage;!function(a){"use strict";a.EmailAPI=function(){this.init()}}(jQuery),$.EmailAPI.prototype={defaults:{url:"https://apiv32.mylifeportal.co.uk/Api/emails",sender:"Birmingham Adoption and Fostering Services",from:"noreply@adoptandfoster.co.uk",subject:"Adoption and Fostering Enquiry",body:"",apiKey:"Supercalifragilisticexpialidocious"},init:function(a){"use strict";var b=this;return b.recipients=[],b.options=$.extend({},b.defaults,a),b},update:function(a){"use strict";var b=this;return b.options=$.extend({},b.defaults,a),b},addRecipient:function(a,b){"use strict";var c=this;if(void 0!==a&&void 0!==a){var d={EmailAddress:a,DisplayName:b};c.recipients.push(d)}return c},writeBack:function(a,b){"use strict";var c=this;return"Success"!==b&&console.log(b+"\n\n"+JSON.stringify(a)),c},send:function(a){"use strict";var b=this;a&&b.update(a);var c={SenderName:b.options.sender,SenderEmailAddress:b.options.from,Subject:b.options.subject,BodyText:b.options.body,IsBodyHtml:!1,Recipients:b.recipients},d=$.ajax({type:"POST",url:b.options.url,data:JSON.stringify(c),dataType:"json",contentType:"application/json",beforeSend:function(a){a.setRequestHeader("X-ApiKey",b.options.apiKey)},success:function(a){var c=void 0!==d?d.responseText:JSON.stringify(a);b.status="Success",b.writeBack(c,b.status)},error:function(a){var c=void 0!==d?d.responseText:JSON.stringify(a);b.status="Error",b.writeBack(c,b.status)},fail:function(a){var c=void 0!==d?d.responseText:JSON.stringify(a);b.status="Fail",b.writeBack(c,b.status)}})}};var email=new $.EmailAPI,FB=FB||{};FB.utils=function(){"use strict";var a=function(a){return a.toLowerCase().replace(/\W/g,"")},b=function(a){return $("[data-id="+a+"]")},c=function(a){var b=a.closest($("[data-id]"));return b.attr("data-id")},d=function(){var a=[];return $.each($("[data-id]"),function(){a.push($(this).data("id"))}),a},e=function(a,b){var c={},d=[];return $.each(a,function(a,e){c[e[b]]||(c[e[b]]=!0,d.push(e))}),d},f=function(a){switch(a.toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(a)}},g=function(a){return $("[data-id="+a+"] select").length>0?!0:!1},h=function(a,b){a.empty(),$.each(b,function(b,c){a.append($("<option></option>").attr("value",c.value).text(c.text))})},i=function(a,b,c){void 0===c&&(c=b),a.append($("<option></option>").attr("value",c).text(b))},j=function(a,b){$("option[value="+b+"]",a).remove()},k=function(a){var b=FB.d(a),c="";if(void 0!==b.fields.radios&&(c=b.fields.radios),void 0!==b.fields.checkboxes&&(c=b.fields.checkboxes),void 0!==b.fields.options&&(c=b.fields.options),""!=c){var d=[];return $.each(c.value,function(a,b){d.push({text:b.text,value:b.value})}),d}return!1},l=function(a,b,c){var d=[];if(""!=a){var e=!0,f=a.split("\n"),g="";return $.each(f,function(a,h){var i="";h=h.trim();var j="";"*"===h.slice(-1)?(j=e,h=h.substring(0,h.length-1).trim(),e=!1):j=!1;var k=h.split(":");switch(1===k.length?i=h:(i=k[0].trim(),h=k[1].trim()),b){case"Options":d.push({text:i,value:h,selected:j});break;case"Column Headings":if(void 0!==c){var l=0;$.each(c,function(a,b){FB.d(b).fields.columnheading.value===!0&&l++}),l>0?f.length<l?g="Warning! You have entered fewer column headings than there are controls in the Table Group. No changes made.":l>a?d.push({text:i,value:c[a],selected:!1}):g="Warning! You have entered more column headings than there are controls in the Table Group. No more added.":g="Warning! You have entered more column headings than there are controls in the Table Group. Reset to default."}else d.push({text:i,value:i,selected:!1});break;default:d.push({text:i,value:h,checked:j})}}),""!=g&&bootbox.alert(g),d}return null},m=function(a){var b="";return $.each(a.split(" "),function(a,c){-1!==c.indexOf("col-")&&(b=c)}),b},n=function(){$(".spinner-container").html('<div class="spinner">Sending...</div>')},o=function(){$(".spinner-container").html("")},p=function(a,b,c){return a.replace(new RegExp(b,"g"),c)},f=function(a){switch(a.toString().toLowerCase()){case"true":case"yes":case"1":case"":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(a)}},q=function(a){for(var b=!0,c=0;c<a.length;c++)switch($.type(a[c])){case"boolean":b=b&&a[c];default:b=b&&f(a[c])}return b},r=function(a){for(var b=window.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(e[0]===a)return e[1]}return""},s=function(a,b){return $("option",a).filter(function(){return $(this).val()==b}).text()},t=function(a,b){return $("option",a).filter(function(){return $(this).html()==b}).val()},u=function(){for(var a="",b=arguments.length,c=0;b>c;c++)""!=arguments[c]&&(a+=arguments[c],b-1>c&&(a+=", "));return a},v=function(a){var b=parseFloat(a);return isNaN(b)?a:b.toFixed(2)},w=function(a){var b=parseFloat(a);return isNaN(b)?a:"&pound; "+b.toFixed(2)},x=function(a,b,c){if(void 0!==window._gaq){var d=void 0!==a?a:"",e=void 0!==b?b:"",f=void 0!==c?c:"";window._gaq.push(["_trackEvent",d,e,f])}return!1},y=function(a){return $._data(a[0],"events")};return{shorten:a,idSequence:d,$id:b,idByElement:c,distinct:e,stringToBoolean:f,isSelect:g,updateSelect:h,addItemToSelect:i,removeItemFromSelect:j,getOptions:k,convertTextToObject:l,getWidth:m,showSpinner:n,hideSpinner:o,replaceAll:p,s2b:f,boolAnd:q,getUrlParameter:r,textByValue:s,valueByText:t,concatIf:u,gaEvent:x,set2dp:v,currencyTest:w,getEvents:y}}();var FB=FB||{},FBRun=FBRun||{};FBRun=function(){"use strict";var a=function(){var a=$('script[src*="?mode"]').attr("src"),b=a.split("?")[1],c=b.split("=")[1];return c},b={classHandler:function(a){return a.$element.closest("[data-id]")},errorsContainer:function(a){return a.$element.closest("[data-id]")},errorTemplate:"<span></span>",excluded:"input[type=button], input[type=submit], input[type=reset], :hidden"},c={formContainer:".form-fb"},d=function(a){return this.options=$.extend({},c,a),this},e=function(){var a=[],b=$("input[type!=submit], select, textarea, .table-group");return $.each(b,function(){var b,c,d,e;d=void 0!==$(this).prop("type")?$(this).prop("type"):"",$(this).hasClass("table-group")&&(d="tablegroup");var f=$(this).attr("id"),g=$(this).attr("name"),h=$(this).closest("[data-id]").attr("data-integration");if("tablegroup"===d)b=FBRun.tablegroup.getData($(this)),c=b,g=f,e=$(this).data("idcol");else if(void 0!==g){var i=g.indexOf("$")>-1?"":$.trim($("label[for="+g+"]").text());switch(i=i.replace(" *",""),d){case"radio":(0===a.length||a[a.length-1].name!==g)&&(b=$("input[name='"+g+"']:checked").val(),void 0===b&&(b=""),c=$.trim($("input[name='"+g+"']:checked").closest("label").text()),void 0===c&&(c=""));break;case"checkbox":if(0===a.length||a[a.length-1].name!==g){var j=[],k=[];$.each($("input[name='"+g+"']:checked"),function(){j.push($(this).val()),k.push($.trim($("input[name='"+g+"']:checked").closest("label").text()))}),b=JSON.stringify(j),c=JSON.stringify(k)}break;case"select-one":b=$(this).val(),c=""===b?"":$("option[value='"+b+"']",$(this)).text();
break;default:b=$(this).val(),c=b}}if(void 0!==b)if($.isArray($(this).val()))a.push({id:f,type:d,name:g,label:i,text:c,val:b,array:!0});else{var l={id:f,type:d,name:g,label:i,text:c,val:b};void 0!==e&&$.extend(l,{idcol:e}),void 0!==h&&($.extend(l,{integration:h}),("radio"===d||"select-one"===d||"checkbox"===d)&&$.extend(l,{code:b})),a.push(l)}}),a},f=function(a){var b="",c=$("[data-id="+a+"]"),d=$("input,select,textarea",c);if(d.length>0){var e=d.prop("type");switch(void 0===e&&(e="text"),e){case"radio":$.each(d,function(a){d[a].checked&&(b=$(this).val())});break;case"checkbox":$.each(d,function(a){d[a].checked&&(b+=$(this).val())});break;case"select-one":b=FB.utils.textByValue(d,d.val());break;case"text":b=d.parent().hasClass("input-group")?FB.utils.set2dp(d.val()):d.val();break;case"textarea":b=d.val();break;case"hidden":b=d.val()}}return null==b?"":b},g=function(a,b){void 0===b&&(b="");var c=$("[data-id="+a+"]"),d=$("input,select,textarea",c);if(d.length>0){var e=d.prop("type");switch(void 0===e&&(e="text"),e){case"radio":$.each(d,function(a){""==b?d[a].checked=!1:b==d[a].value&&(d[a].checked=!0)});break;case"checkbox":$.each(d,function(a){""==b?d[a].checked=!1:b==d[a].value&&(d[a].checked=!0)});break;case"select-one":var f=$("option[selected]",d).val();void 0!==f&&""==b?d.val(f):d.val(FB.utils.valueByText(d,b));break;case"text":d.val(b);break;case"textarea":d.val(b)}FBRun.vis.evaluate(a)}return!1},h=function(a){var b=$("[data-id="+a+"]");void 0!==b&&(b.hasClass("page")?$.each($("[data-id]",b),function(){h($(this).data("id"))}):$("table",b).length>0?$("td",b).remove():g(a))};return{defaults:c,getMode:a,parsleyOptions:b,init:d,inputs:e,getControlValue:f,setControlValue:g,empty:h}}();var FBRun=FBRun||{};FBRun.nav=function(){"use strict";var a=function(){var a,b,c,d=$(".form-fb");return d.removeAttr("style"),a=d.height(),b=$(".footer").height(),c=$("body").height()-b-30,c>a&&d.height(c),!1},b=function(a){var b="",c=$("#"+a).nextAll().not("[data-hidden]");return $.each(c,function(a){0===a&&(b=$(this).attr("id"))}),b},c=function(a){var b="",c=$("#"+a).prevAll().not("[data-hidden]");return $.each(c,function(a){0===a&&(b=$(this).attr("id"))}),b},d=function(c){if($(FBRun.defaults.formContainer).parsley(FBRun.parsleyOptions).validate(c)===!0){var d=b(c);$(".page[id!="+d+"]").addClass("hide"),$("#"+d).removeClass("hide");var e=$(".sidenav li[data-page="+d+"]");e.addClass("active"),e.removeClass("disabled"),$("a",e).attr("onclick","FBRun.nav.moveTo('"+d+"')"),$(".sidenav li[data-page="+c+"]").removeClass("active"),a(),$(FBRun.defaults.formContainer).parsley(c).reset()}},e=function(b){var d=c(b);$(".page[id!="+d+"]").addClass("hide"),$("#"+d).removeClass("hide");var e=$(".sidenav li[data-page="+d+"]");e.addClass("active"),$(".sidenav li[data-page="+b+"]").removeClass("active"),a()},f=function(b){$(".page[id!="+b+"]").addClass("hide"),$("#"+b).removeClass("hide");var c=$(".sidenav li[data-page="+b+"]");c.addClass("active"),c.removeClass("disabled"),$("a",c).attr("onclick","FBRun.nav.moveTo('"+b+"')"),$(".sidenav li").not("[data-page="+b+"]").removeClass("active"),a()},g=function(a,b){void 0===b&&(b=40);var c=$(window).width(),d=$(window).height();c-=2*b,d-=2*b;var e=window.open("","_blank","toolbar=no, scrollbars=yes, resizable=yes, top="+b+", left="+b+", width="+c+", height="+d);void 0!==a&&e.document.write(a)},h=function(){var a='<!DOCTYPE html><html><head><meta charset="utf-8"><link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css" /><link rel="stylesheet" href="css/style.css"></head><body><div class="container"><table id="table" class="table table-bordered"><tr><th>Id</th><th>Name</th><th>Label</th><th>Value</th></tr>';return $.each(FBRun.inputs(),function(b,c){a+="<tr><td>"+c.id+"</td><td>"+c.name+"</td><td>"+c.label+"</td><td>"+c.val+"</td></tr>"}),a+="</table></div></body></html>",g(a,200),!1},i=function(a){return $(FBRun.defaults.formContainer).parsley(FBRun.parsleyOptions).validate(a)===!0?($(".btn-submit").attr("disabled","disabled"),h(),!1):void 0};return{moveNext:d,moveBack:e,moveTo:f,showFormData:h,submitAction:i,setHeight:a}}();var FB=FB||{},FBRun=FBRun||{};FBRun.tablegroup=function(){"use strict";var a=function(a){$("[data-event-model=pub]",a).length>0&&$.each($("[data-event-model=pub]",a),function(){var a=$(this).data("eventType");$(this).trigger(a)})},b=function(a){$.each($("select,input,textarea",a),function(){$(this).trigger("change")})},c=function(a,b){var c="<td>";return c+='<div class="btn-group">',c+='<button type="button" class="btn btn-default">Action</button>',c+='<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">',c+='<span class="caret"></span>',c+='<span class="sr-only">Toggle Dropdown</span>',c+="</button>",c+='<ul class="dropdown-menu" role="menu">',c+='<li><a href="#" onclick="FBRun.tablegroup.editRow('+a+","+b+')">Edit</a></li>',c+='<li><a href="#" onclick="FBRun.tablegroup.deleteRow('+a+","+b+')">Delete</a></li>',c+="</ul>",c+="</div>",c+="</td>"},d=function(d,e){var f,g=$("table",d),h=$("tr",g).length,i="";i='<tr data-row="'+h+'">',$.each($("[data-id]",d),function(){void 0===$(this).data("coldata")?FBRun.setControlValue($(this).data("id")):(i+=void 0===$(this).data("colshow")?'<td class="hide">':"<td>",i+=FBRun.getControlValue($(this).data("id"))+"</td>",FBRun.setControlValue($(this).data("id")))}),f=FBRun.getMode(),f.indexOf("bootstrap3")>-1&&(i+=c(e,h)),i+="</tr>",g.append(i),g.removeClass("hide"),$(FBRun.defaults.formContainer).parsley(e).reset(),$(".table-group-items",d).slideUp(200),a(d),b(d)},e=function(a,b){var c=$("[data-id="+b+"]");"add"===a.data("mode")?$(FBRun.defaults.formContainer).parsley(FBRun.parsleyOptions).validate(b)===!0&&(d(c,b),a.data("mode","show"),a.text(a.data("closedlabel")),a.removeClass("btn-danger").addClass("btn-primary"),$(FBRun.defaults.formContainer).parsley(b).reset()):($(".table-group-items",c).slideDown(),a.data("mode","add"),a.text(a.data("label")),a.removeClass("btn-primary").addClass("btn-danger"))},f=function(a,b){var c,d=$("[data-id="+a+"]"),e=$("tr[data-row="+b+"]",d),f=$("[data-id]",d).length;return $.each($("td",e),function(a){if(f>a){var b=$($("[data-coldata]:eq("+a+")",d)),c=b.data("id");FBRun.setControlValue(c,$(this).text()),FBRun.vis.evaluate(c)}}),c=$("button[data-mode]",d),c.data("mode","update"),c.text("Update"),c.attr("onclick","FBRun.tablegroup.updateRow("+a+","+b+");"),$(".table-group-items",d).slideDown(200),!1},g=function(c,d){if($(FBRun.defaults.formContainer).parsley(FBRun.parsleyOptions).validate(c)===!0){var e,f,g=$("[data-id="+c+"]"),h=$("tr[data-row="+d+"]",g);$.each($("[data-coldata]",g),function(a){var b=$("td:eq("+a+")",h);b.text(FBRun.getControlValue($(this).data("id"))),FBRun.setControlValue($(this).data("id"))}),$(".table-group-items",g).slideUp(200),f=$("button[data-mode]",g),f.data("mode","show"),e=FBRun.getMode(),e.indexOf("bootstrap3")>-1&&f.text(f.data("closedlabel")),f.attr("onclick","FBRun.btnAction($(this), "+c+");"),$(FBRun.defaults.formContainer).parsley(c).reset(),a(g),b(g)}},h=function(b,c){var d=$("[data-id="+b+"]"),e=$("tr[data-row="+c+"]",d);bootbox.confirm("Are you sure you want to delete this row?",function(b){b&&(e.remove(),a(d))})},i=function(a,b){var c,d;if(void 0===a[0].length||0===a[0].length)for(c=0;b>c;c++)a.push("");else for(d=0;d<a.length;d++)i(a[d],b);return a},j=function(a){var b=a.closest("[data-id]").attr("id"),c=[],d=[];return $.each($("tr",a),function(b,e){d=[],d.push(b);var f=$("td",e).length-1;$.each($("td",$(this)),function(b){if(f>b){var c=$("[data-coldata]:eq("+b+")",a),e=$(this).text();FB.utils.isSelect(c.data("id"))?d.push(FB.utils.valueByText($("select",c),e)):d.push(e)}}),b>0&&c.push(d)}),JSON.stringify({name:b,data:c})},k=function(a,b,c){return $.each(a,function(){if(void 0===a)var a=void 0!==$(this).data("idcol")?!0:!1;if($(this).length>0){var c=$("table",$(this)),d=$("th",c).length,e=b[0].length,f=a?1:0;if(d>e&&i(b,d-e),d>0){var g="";$.each(b,function(b,c){g+="<tr>",$.each(c,function(b,c){0===b?a&&(g+="<td>"+c+"</td>"):d>=b+f&&(g+="<td>"+c+"</td>")}),g+="</tr>"}),c.append(g)}}}),!1},l=function(a){var b=[];return a.length>0?($.each(a,function(a,c){1===c.length?b.push([a,c]):(c.splice(0,0,a),b.push(c))}),b):null},m=function(a,b){var c=JSON.parse(j(a));return k(b,c.data),!1};return{btnAction:e,addRow:d,editRow:f,updateRow:g,deleteRow:h,getData:j,setData:k,copyTable:m,convertArrayToTableData:l}}();var FB=FB||{},FBRun=FBRun||{},subscribers=[];$.each($("[data-event-model=sub]"),function(){"use strict";subscribers.push($(this).data("eventName"))}),$.each($.unique(subscribers),function(a,b){"use strict";$.subscribe(b,function(a,c){window[b](b,c)})}),$("[data-event-type=click]").on("click",sendId),$("[data-event-type=change]").on("change",sendId);var copyVal=function(a,b){"use strict";var c=$("[data-id="+b+"]"),d=$("[data-event-name="+a+"]",c),e=$("[data-event-model=sub][data-event-name="+a+"]");e.hasClass("form-control-static")?e.text(d.val()):e.val(d.val())},copyRowToSelect=function(a,b){"use strict";var c=$("[data-id="+b+"]"),d=$("[data-event-model=sub][data-event-name="+a+"]"),e=FBRun.tablegroup.getData($("table",c)),f=JSON.parse(e),g=f.data,h=[];$.each(g,function(a,b){h.push({text:b[1],value:b[0]})}),FB.utils.updateSelect(d,h)};Array.prototype.filter||(Array.prototype.filter=function(a){"use strict";if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments[1],f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d});var FBRun=FBRun||{};FBRun.dates=function(){"use strict";var a=function(a,b){if(""!==a){var c,d,e=a.substr(6,4),f=a.substr(3,2),g=a.substr(0,2),h=new Date,i=new Date;i.setFullYear(e,f,g),c=Math.abs(h-i),d=Math.floor(c/31536e6),b.val(d)}},b=function(){var b=new Date,c=new Date(b.getFullYear(),b.getMonth(),b.getDate(),0,0,0,0);$(".datepicker").datepicker({format:"dd/mm/yyyy"}).on("changeDate",function(){$(this).datepicker("hide")}),$(".datepicker-future").datepicker({format:"dd/mm/yyyy",startDate:c}).on("changeDate",function(){$(this).datepicker("hide")}),$(".datepicker-dob").datepicker({format:"dd/mm/yyyy",startView:"decade",keyboardNavigation:!1}).on("changeDate",function(){$(this).datepicker("hide")}),$(".datepicker-dob").on("change",function(){var b=$(this).val(),c=$(this).attr("id")+"age",d=$("#"+c),e=FB.utils.idByElement(d);a(b,d),FBRun.vis.evaluate(e),$(this).datepicker("hide")})};return{applyDatePickers:b}}();var FB=FB||{},FBRun=FBRun||{};FBRun.init(),$.fn.toCurrency=function(){"use strict";var a=FB.utils.currencyTest(this.val());return this.val(a.substring(8)),this},FBRun.nav.setHeight();var FB=FB||{},FBRun=FBRun||{},vis=vis||{rules:[],triggers:[]},V=function(a){return FBRun.getControlValue(a)};FBRun.vis=function(){"use strict";var defaults={blankHiddenControls:!0},applyRule=function(a,b){if(a.hasClass("page")){var c;$.each(a,function(){b?($(this).removeAttr("data-hidden"),c=$(this).attr("id"),$("li[data-page="+c+"]").removeClass("hide")):($(this).attr("data-hidden","true"),c=$(this).attr("id"),$("li[data-page="+c+"]").addClass("hide"))})}else $.each(a,function(){var a=$(this).data("id");b?($(this).hasClass("hide")&&$(this).removeClass("hide"),evaluate(a)):($(this).hasClass("hide")||$(this).addClass("hide"),FBRun.vis.options.blankHiddenControls?(FBRun.setControlValue(a),evaluate(a)):evaluate(a,!1))})},evaluate=function(controlId,forceVis){var ruleList=[];ruleList=void 0===controlId?vis.rules:$.map(vis.triggers,function(a){return parseInt(a.cid)===parseInt(controlId)?$.map(vis.rules,function(b){return parseInt(b.id)===parseInt(a.rid)?b:void 0}):void 0}),$.each(ruleList,function(k,v){void 0!==forceVis?applyRule($("[data-vis="+v.id+"]"),forceVis):applyRule($("[data-vis="+v.id+"]"),eval(v.rule))})},visChange=function(a){var b=$(this).closest("[data-id]").data("id");evaluate(b)},init=function(a){return this.options=$.extend({},defaults,a),$.each(FB.utils.distinct(vis.triggers,"cid"),function(a,b){$("[data-id="+b.cid+"] input, select, textarea").bind("change",visChange)}),evaluate(),$.listen("parsley:field:validated",function(a){return a.$element.is(":hidden")?(a._ui.$errorsWrapper.css("display","none"),a.validationResult=!0,!0):void 0}),this};return{evaluate:evaluate,applyRule:applyRule,init:init}}(),function(a){"use strict";a.ShelterTemplates=function(){this.init()}}(jQuery),$.ShelterTemplates.prototype={init:function(){"use strict";this.property=1},replaceAll:function(a,b,c){"use strict";return c.replace(new RegExp(a,"g"),b)},panelTpl:function(a){"use strict";var b=this,c='<div id="property-template-p{{property}}">   <!-- Affordability Table -->   <div class="row">       <div class="col-md-12">           <div class="form-group">               <label for="statictextp{{property}}-1" class="hide control-label">Income and Expenditure Summary</label>               <div class="col-sm-12">                   <p id="statictextp{{property}}-1" name="statictextp{{property}}-1" class="form-control-static subhead">Affordability</p>               </div>           </div>           <div class="table-responsive" id="incandexpsummaryp1">               <table class="table table-bordered table-striped">                   <thead>                       <tr>                           <th>Item</th>                           <th>Monthly</th>                           <th>Weekly</th>                       </tr>                   </thead>                   <tbody>                   </tbody>               </table>           </div>       </div>   </div><!-- End Affordability Table -->   <!-- Alerts Table -->   <div class="row">       <div class="col-md-12">           <div class="form-group">               <label for="statictextp{{property}}-2" class="hide control-label">Alerts</label>               <div class="col-sm-12">                   <p id="statictextp{{property}}-2" name="statictextp{{property}}-2" class="form-control-static subhead">Alerts               </p>               </div>           </div>           <div class="table-responsive" id="alertsout">               <table class="table table-bordered table-striped">                   <thead>                       <tr>                           <th>Information</th>                       </tr>                   </thead>                   <tbody>                   </tbody>               </table>           </div>       </div>   </div><!-- End Alerts Table -->   <!-- Buttons -->   <div class="row">       <div class="col-md-6">           <button class="btn btn-danger btn-summary-p{{property}} col-md-12">Print Summary</button>       </div>       <div class="col-md-6">           <button class="btn btn-danger btn-details-p{{property}} col-md-12" onclick="showDetails({{property}});">View Details</button>       </div>   </div><!-- End Buttons -->';return b.replaceAll("{{property}}",a,c)},alertTpl:function(a,b,c){"use strict";var d=this,e='<div class="row">   <div class="col-md-12">        <div class="form-group">            <div class="alert alert-warning alert-dismissable">                <a class="close" href="#" data-dismiss="alert" aria-hidden="true">&times;</a>                <div>                    <h4>Your current property is not affordable</h4>                </div>                <div>                    <p>Do you want to find other areas where the average rental is affordable for you?</p>                    <button class="btn btn-danger btn-lha-{{property}}" onclick="updateAffordableLhas({{rent}}, {{rooms}}, {{mode}});">Find affordable areas</button>                </div>            </div>        </div>    </div></div>',f="";return f=d.replaceAll("{{property}}",a,e),f=d.replaceAll("{{rent}}",b,f),f=d.replaceAll("{{rooms}}",c,f),f=d.replaceAll("{{mode}}","'"+$("#mode").val()+"'",f)}};var FBRun=FBRun||{};FBRun.northing=[],FBRun.easting=[];var results=[{html:"",property:""}],AGE=3,RELATIONSHIP=5,EMP_STATUS=6,copyLeadName=function(a){"use strict";var b=$("[data-event-model=sub][data-event-name="+a+"]"),c=$("#fname").val()+" "+$("#lname").val();b.val(c)},copyName=function(a,b){"use strict";var c=$("[data-id="+b+"]"),d=$("[data-event-model=sub][data-event-name="+a+"]"),e=FBRun.tablegroup.getData($("table",c)),f=JSON.parse(e),g=f.data,h=$.grep(g,function(a,b){return"Client"===a[5]||"Spouse or partner"===a[5]}),i=[];$.each(h,function(a,b){i.push({text:b[1],value:b[0]})});var j=d.not("[id=nonname]").not("[id=othname]").not("[id=benname]");FB.utils.updateSelect(j,i);var k=$.grep(g,function(a,b){return"Client"===a[5]||"Spouse or partner"===a[5]||"Child"===a[5]||"Foster Child"===a[5]}),l=[];$.each(k,function(a,b){l.push({text:b[1],value:b[0]})}),FB.utils.updateSelect($("#othname"),l);var m=$.grep(g,function(a,b){return"Client"===a[5]||"Spouse or partner"===a[5]||"Child"===a[5]}),n=[];$.each(m,function(a,b){n.push({text:b[1],value:b[0]})}),FB.utils.updateSelect($("#benname"),n);var o=$.grep(g,function(a,b){return a[5].indexOf("dep")>-1}),p=[];$.each(o,function(a,b){p.push({text:b[1],value:b[0]})}),FB.utils.updateSelect($("#nonname"),p),incomeVisibility()};$("#svcother").bind("change",{target:$("#svctype")},addOtherValue),$("#priother").bind("change",{target:$("#pritype")},addOtherValue),$("#nonother").bind("change",{target:$("#nontype")},addOtherValue);var filterBrma=function(a,b,c){"use strict";var d,e=[];return console.log(c),console.log(FBRun.northing),b>4&&(b=4),FBRun.lha.forEach(function(f){for(d in f)parseInt(d,10)===parseInt(b,10)&&parseFloat(f[d])<=parseFloat(a)&&e.push([f.name,FB.utils.currencyTest(f[d]),getDistance(FBRun.easting[c],FBRun.northing[c],f.easting,f.northing)])}),e},updateAffordableLhas=function(a,b,c){"use strict";var d,e="<h4>Search for LHA rates with weekly rent below "+FB.utils.currencyTest(a)+" and "+b+" bedroom"+(b>1?"s":"")+".</h4>",f='<div class="table-responsive" id="lha-table">    <table class="table table-bordered table-striped" id="locations">        <thead>            <tr>                <th>Local Housing Authority</th>                <th>Price</th>                <th>Distance (miles)</th>            </tr>        </thead>        <tbody>        </tbody>    </table></div>';feedback.open({title:e,message:f,buttonLabel:"none"}),$("#lha-table").parent().parent().addClass("scrollable"),d=filterBrma(a,parseInt(b,10),c),FBRun.tablegroup.setData($("#lha-table"),FBRun.tablegroup.convertArrayToTableData(d)),$("#locations").tablesorter({sortList:[[2,0],[1,0]]})},setFormMode=function(a,b){"use strict";var c=$("[data-id="+b+"]"),d=$("[data-event-name="+a+"]",c),e=$("[data-event-model=sub][data-event-name="+a+"]"),f="";switch(FBRun.empty(204),FBRun.empty(127),calc.init(),results=[],d.text()){case"Staying Put":f="SP",$("#p17 .btn-next").addClass("hide");break;case"Moving On":f="MO",$("#p17 .btn-next").addClass("hide"),laAutoComplete();break;case"Staying Put and Moving On":f="SP",$("#p17 .btn-next").removeClass("hide"),$("#p17 .btn-submit").addClass("hide"),laAutoComplete()}e.val(f),$("#mode").trigger("change"),FBRun.nav.moveTo("p1")};!function(a){"use strict";a.Feedback=function(){this.init()}}(jQuery),$.Feedback.prototype={defaults:{title:"Feedback and Problems",url:"https://support.olmsystems.com",buttonLabel:"Open Support Website",message:""},init:function(a){"use strict";var b=this;return b.options=$.extend({},b.defaults,a),b},open:function(a){"use strict";var b=this,c=void 0!==window.bowser?"browser = "+JSON.stringify(bowser)+";":"",d=calc.results.length>0?"calcData = "+JSON.stringify(calc.results)+";":"request = "+JSON.stringify(calc.request)+"\n\nresponse = "+JSON.stringify(calc.response),e="",f={};b.options=$.extend({},b.defaults,a),e+='<p>Please raise a support call with OLM by clicking the button below.  This will open a new website.</p><ul><li>Select "Raise new"</li><li>Product: A4dability</li><li>Schema: Select the most appropriate call type</li><li>Attachment: Word or Excel 97 to 2003 only</li><li>Description: Please explain your issue, request, question or feedback. If there is any text in the box below, please copy and paste it into the Details section.</li><li>Submit</li></ul>',e+='<div class="form-group">',e+='<p class="bold">Please copy and paste text below into the support call</p>',e+='<textarea id="datatext" name="datatext" rows="10" class="form-control" tabindex="1">'+c+"\n\n"+d+"</textarea>",e+="</div>","none"!==b.options.buttonLabel&&(f={success:{label:b.options.buttonLabel,className:"btn-success",callback:function(){window.open(b.options.url)}}}),""!=b.options.message&&(e=b.options.message),bootbox.dialog({message:e,title:b.options.title,buttons:f})}};var feedback=new $.Feedback,demo={timeOut:1e3,pageActions:[{id:"#p16",actions:function(){$("#so-btn").click()}},{id:"#p1",actions:function(){$("#fname").val("Mark"),$("#lname").val("Fairhurst"),$("#address1").val("10"),$("#address2").val("Tawney Close"),$("#address3").val("Corsham"),$("#postcode").val("SN13 9XE"),$("#hometel").val("01225 811730"),$("#mobiletel").val("07557 649609"),$("#email").val("mark@fairhursts.net")}},{id:"#p2",actions:function(){FBRun.setControlValue(12,"Mark Fairhurst"),FBRun.setControlValue(13,"31/12/1969"),FBRun.setControlValue(27,"45"),FBRun.setControlValue(14,"Male"),FBRun.setControlValue(15,"Client"),FBRun.setControlValue(16,"Employed - full-time"),FBRun.setControlValue(17,"N"),FBRun.setControlValue(18,""),FBRun.setControlValue(19,""),FBRun.setControlValue(21,""),FBRun.setControlValue(22,"Y"),FBRun.setControlValue(23,"Y"),FBRun.setControlValue(24,""),$("#p2 button[data-mode=add]").click()}},{id:"#p3",actions:function(){FBRun.setControlValue(30,"Mark Fairhurst"),FBRun.setControlValue(31,"OLM Systems"),FBRun.setControlValue(32,"37.5"),FBRun.setControlValue(48,"3000"),$("#p3 button[data-mode=add]").click()}},{id:"#p4",actions:function(){}},{id:"#p5",actions:function(){}},{id:"#p6",actions:function(){}},{id:"#p7",actions:function(){}},{id:"#p8",actions:function(){FBRun.setControlValue(76,"Owner occupier - freehold"),FBRun.setControlValue(82,"N"),FBRun.setControlValue(88,"N"),FBRun.setControlValue(83,"N"),FBRun.setControlValue(84,"Detached"),FBRun.setControlValue(85,"8"),FBRun.setControlValue(220,"5"),FBRun.setControlValue(86,"2030")}},{id:"#p9",actions:function(){}},{id:"#p10",actions:function(){FBRun.setControlValue(100,"Gas"),FBRun.setControlValue(101,"Gas"),FBRun.setControlValue(102,"Gas"),FBRun.setControlValue(103,"Electricity"),FBRun.setControlValue(104,"Electricity")}},{id:"#p11",actions:function(){}},{id:"#p12",actions:function(){}},{id:"#p13",actions:function(){}},{id:"#p14",actions:function(){}},{id:"#p17",actions:function(){}}],run:function(){var a,b,c=this;c.pageActions.reverse(),b=setInterval(function(){0===c.pageActions.length?clearInterval(b):(a=c.pageActions.pop(),a.actions(),setTimeout(function(){$(".btn-next",$(a.id)).click()},c.timeOut))},c.timeOut)},list:function(){var a,b,c="",d=!1;return $(".page").each(function(e){a=$(this).attr("id"),c+="{\n",c+="    id: '#"+a+"',\n",c+="    actions: function() {\n",$("[data-id]",$(this)).each(function(a){b=$(this).attr("data-id"),$(this).hasClass("table-group")?d=!0:$("input, select, radio, textarea",$(this)).each(function(a){c+="        FBRun.setControlValue("+b+", ''); /*"+$(this).attr("name")+"*/\n"})}),d&&(c+="        $('#"+a+" button[data-mode=add]').click();\n",d=!1),c+="    }\n",c+="},\n"}),c}};